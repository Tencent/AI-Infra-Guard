info:
  name: ollama
  author: 腾讯朱雀实验室
  severity: info
  desc: 一个开源工具，允许在本地运行大语言模型，确保数据隐私和控制。
  metadata:
    product: ollama
    vendor: ollama
http:
  - method: GET
    path: '/'
    matchers:
      - body="Ollama is running" || title="Ollama" || body="ollama"
  - method: GET
    path: '/api/tags'
    matchers:
      - body="models" && (body="name" || body="size")
  - method: GET
    path: '/api/version'
    matchers:
      - body="version"
  - method: GET
    path: '/v1/models'
    matchers:
      - body="object" && body="data"
version:
  - method: GET
    path: '/api/version'
    extractor:
      part: body
      group: 1
      regex: \{"version"\s*:\s*"([0-9]+\.[0-9]+(?:\.[0-9]+)?)"\}
  - method: GET
    path: '/v1/models'
    extractor:
      part: headers
      group: 1
      regex: ollama/([0-9]+\.[0-9]+(?:\.[0-9]+)?)
