info:
  name: LiteLLM
  cve: CVE-2024-4888
  summary: LiteLLM 中因输入验证不当导致的任意文件删除漏洞
  details: |
    LiteLLM 的 `/audio/transcriptions` 接口由于输入验证不足，存在任意文件删除的安全风险。
    攻击者可以发送包含特定文件路径的恶意请求，从而在服务器上未经授权地删除文件。
    这可能导致关键系统文件（如 SSH 密钥、数据库或配置文件）被删除，造成严重后果。
    此问题源于代码中不安全地使用了 `os.remove(file.filename)`，且未对文件路径进行有效校验。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 升级至 LiteLLM 版本 1.35.36 或更高版本。
    2. 对所有用户提供的文件路径实施严格的输入验证。
    3. 在 API 接口中对文件系统操作进行访问限制和路径净化处理。
rule: version >= "0" && version < "1.35.36"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4888
  - https://github.com/BerriAI/litellm/pull/3193
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/48461d89-cf13-4ad3-a43e-0d37da08fc6c