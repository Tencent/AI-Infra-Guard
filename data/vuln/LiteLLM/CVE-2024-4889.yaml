info:
  name: LiteLLM
  cve: CVE-2024-4889
  summary: LiteLLM 中因密钥管理中不安全的 eval 使用导致代码注入漏洞
  details: |
    LiteLLM 版本 1.34.6 中存在一个代码注入漏洞，该漏洞是由于密钥管理系统中的 `eval` 函数接收了未经验证的输入。
    攻击者在拥有有效的 Google KMS 配置访问权限的情况下，可以通过在 `get_image` 函数中将 `UI_LOGO_PATH` 变量设置为远程服务器地址来利用此漏洞。
    这样可以将恶意的 Google KMS 配置写入到 `cached_logo.jpg` 文件中，并通过向 `SAVE_CONFIG_TO_DB` 环境变量注入恶意内容来执行任意代码。
    成功利用该漏洞可获得对系统的完全控制权，但前提是攻击者需已具备访问 Google KMS 功能的权限。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 LiteLLM 升级至已修复的版本（如可用）或应用供应商提供的补丁
    2. 如非必要，请避免使用 Google KMS 功能
    3. 对所有输入进行清理和验证，特别是那些由使用 `eval` 的函数处理的输入
    4. 限制对影响运行时行为的环境变量的访问
rule: version == "1.34.6"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4889
  - https://huntr.com/bounties/be3fda72-a65b-4993-9a0e-7e0f05db51f8