info:
  name: LiteLLM
  cve: CVE-2024-4890
  summary: LiteLLM 的 /team/update 端点存在盲 SQL 注入漏洞
  details: |
    在 LiteLLM 版本 1.27.14 中的 `/team/update` 处理过程中发现了一个盲 SQL 注入漏洞。
    此问题源于用于删除用户的原始 SQL 查询中对 `user_id` 参数的不当清理。
    这使得具有低权限的已认证攻击者能够注入恶意 SQL 命令，可能访问数据库中存储的敏感数据，
    如 API 密钥、用户信息和令牌。
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到已修复的 LiteLLM 版本（版本号 > 1.27.14）。
    2. 对所有用户提供的输入进行清理，特别是用于原始 SQL 查询中的参数。
    3. 使用参数化查询或 ORM 方法以防止直接的 SQL 注入。
rule: version <= "1.27.14"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4890
  - https://github.com/BerriAI/litellm/pull/2954
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/a4f6d357-5b44-4e00-9cac-f1cc351211d2