info:
  name: LiteLLM
  cve: CVE-2024-5225
  summary: LiteLLM 的 /global/spend/logs 端点存在 SQL 注入漏洞
  details: |
    在 `berriai/litellm` 仓库的 `/global/spend/logs` 端点中存在一个 SQL 注入漏洞。
    此问题源于对 `api_key` 参数中的特殊元素未进行适当净化，该参数被直接拼接到 SQL 查询语句中而未经验证。
    这使得低权限攻击者能够注入恶意 SQL 代码，可能导致未经授权的数据访问、篡改、信息泄露以及拒绝服务。
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
  severity: HIGH
  security_advise: |
    1. 升级至 LiteLLM 版本 1.40.0 或更高版本。
    2. 对所有用户输入数据进行清理和验证，特别是用于数据库查询的参数。
    3. 使用参数化查询或 ORM 方法以防止在 SQL 语句中直接使用字符串拼接。
rule: version >= "0" && version < "1.40.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5225
  - https://github.com/BerriAI/litellm/pull/3940
  - https://github.com/BerriAI/litellm/commit/f75c15d6cd535aa78014378ad532de1df6be2f56
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/491e4884-0306-4cd4-8fe2-9a19de33bf5c