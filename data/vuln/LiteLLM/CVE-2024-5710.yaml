info:
  name: LiteLLM
  cve: CVE-2024-5710
  summary: LiteLLM 团队管理功能中的权限控制不当
  details: |
    LiteLLM 版本 1.34.34 在其团队管理接口中存在权限控制不当的漏洞。
    授权检查不充分，导致低权限攻击者可执行未授权操作，
    包括创建、更新、删除、封禁/解封团队以及管理团队成员等。
    此问题源于受影响的 API 路由中缺失或薄弱的访问控制验证机制。
  cvss: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级至 LiteLLM 1.40.15 或更高版本。
    2. 审查并为所有团队管理接口实施严格的基于角色的访问控制（RBAC）。
    3. 审核现有用户权限和 API 密钥范围，确保遵循最小权限原则。
rule: version >= "0.0.0" && version < "1.40.15"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5710
  - https://github.com/BerriAI/litellm/commit/da3ae00bd68f451ed8ddf0bc0a9fd34bde5554d6
  - https://github.com/BerriAI/litellm/blob/224148d6133ee50801cb129cbd21ccc213992e25/litellm/proxy/auth/user_api_key_auth.py#L1020
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/70897f59-a966-4d93-b71e-745e3da91970