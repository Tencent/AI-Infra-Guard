info:
  name: LiteLLM
  cve: CVE-2024-5751
  summary: 由于不安全地使用 eval，LiteLLM 存在远程代码执行漏洞
  details: |
    LiteLLM 版本 v1.35.8 中的 `add_deployment` 函数存在远程代码执行漏洞。
    该函数会解码并解密经过 base64 编码的环境变量，并将其不安全地赋值给 `os.environ`。
    攻击者可以向 `/config/update` 接口发送恶意载荷。当 `get_secret` 函数处理该载荷时，
    恶意代码将被执行。此漏洞要求服务器配置了 Google KMS 和用于模型存储的数据库。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 LiteLLM 1.40.16 或更高版本。
    2. 避免通过类似 `/config/update` 的接口处理不受信任的配置更新。
    3. 对所有输入进行清理和验证，特别是那些影响环境变量赋值的输入。
rule: version >= "0" && version < "1.40.16"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5751
  - https://github.com/BerriAI/litellm/pull/4228
  - https://github.com/BerriAI/litellm/commit/fcea4c22ad96b24436f196ae709f71932e84b0b8
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/ae623c2f-b64b-4245-9ed4-f13a0a5824ce