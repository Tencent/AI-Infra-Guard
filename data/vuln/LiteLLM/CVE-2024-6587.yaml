info:
  name: LiteLLM
  cve: CVE-2024-6587
  summary: LiteLLM 中存在服务器端请求伪造（SSRF）漏洞
  details: |
    LiteLLM 版本 1.38.10 中存在服务器端请求伪造（SSRF）漏洞。
    当用户在向 `POST /chat/completions` 发起请求时指定 `api_base` 参数，
    应用程序会将请求转发到攻击者控制的域名，其中包括 OpenAI API 密钥。
    攻击者可利用此漏洞截取敏感凭证，并获得对外部服务的未授权访问权限。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 升级至 LiteLLM 版本 >= 1.44.8
    2. 对 `api_base` 输入参数实施严格校验
    3. 清理并限制出站网络请求仅允许访问受信任的域名
rule: version >= "0" && version < "1.44.8"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6587
  - https://github.com/berriai/litellm/commit/ba1912afd1b19e38d3704bb156adf887f91ae1e0
  - https://github.com/berriai/litellm
  - https://huntr.com/bounties/4001e1a2-7b7a-4776-a3ae-e6692ec3d997