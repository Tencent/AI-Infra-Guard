info:
  name: LiteLLM
  cve: CVE-2024-6825
  summary: LiteLLM 中由于不安全地处理回调函数导致的远程代码执行（RCE）漏洞
  details: |
    在 LiteLLM 版本 1.40.3.dev2 至 1.40.12 中，应用程序对 'post_call_rules' 配置的处理不当。攻击者可以通过操纵函数路径，将系统方法（例如 'os.system'）指定为回调函数。应用程序会将提供的值按最后一个 '.' 进行分割，将后缀视为函数名，并尝试导入前缀加上 '.py' 扩展名的模块。这会导致在处理聊天响应时执行任意命令。
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级到已修复的 LiteLLM 版本（版本号 > 1.40.12）。
    2. 避免在 'post_call_rules' 中使用不受信任的输入。
    3. 对所有用于动态代码加载的用户可控路径进行清理和验证。
rule: version >= "1.40.3.dev2" && version <= "1.40.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6825
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/056913fd7049923a106130b02d7c29e7f312beec/litellm/utils.py#L2818
  - https://huntr.com/bounties/1d98bebb-6cf4-46c9-87c3-d3b1972973b5