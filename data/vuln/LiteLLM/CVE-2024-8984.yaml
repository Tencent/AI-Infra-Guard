info:
  name: LiteLLM
  cve: CVE-2024-8984
  summary: 通过构造的HTTP请求在LiteLLM中引发拒绝服务（DoS）漏洞
  details: |
    在LiteLLM版本v1.44.5中发现了一个拒绝服务（DoS）漏洞。
    当攻击者在HTTP请求中的multipart边界末尾附加诸如破折号（-）等字符时，会触发该问题。
    这会导致服务器进入持续处理循环，消耗大量资源，最终导致服务不可用。
    此漏洞无需身份验证，且无需用户交互即可影响所有服务用户。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将LiteLLM升级至1.56.2或更高版本。
    2. 对multipart边界实施输入验证，防止格式错误的数据触发资源耗尽。
    3. 监控传入的HTTP请求，识别可能表明利用尝试的异常模式。
rule: version >= "1.44.5" && version < "1.56.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-8984
  - https://github.com/BerriAI/litellm/commit/4f49f836aa844ac9b6bfbeff27e6f6b2b9cf3f61
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/8c5ff150f6142608ffe968e4e68429f978fda187/litellm/tests/test_spend_logs.py#L242
  - https://huntr.com/bounties/554fc76b-3097-4223-b4cf-110b853e9355