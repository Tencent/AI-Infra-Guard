info:
  name: LiteLLM
  cve: CVE-2024-9606
  summary: LiteLLM 因日志文件中的掩码不足导致部分 API 密钥泄露
  details: |
    在 LiteLLM 1.44.12 之前的版本中，`litellm_logging.py` 文件存在一个漏洞，
    日志中仅对 API 密钥的前 5 个字符进行了掩码处理。这几乎暴露了完整的 API 密钥，
    严重破坏其机密性，并增加了未授权访问敏感服务的风险。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 LiteLLM 1.44.12 或更高版本。
    2. 检查现有日志文件中是否包含已暴露的 API 密钥，并立即轮换它们。
    3. 实施更严格的日志过滤机制，防止未来密钥等敏感信息泄露。
rule: version >= "0" && version < "1.44.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9606
  - https://github.com/berriai/litellm/commit/9094071c4782183e84f10630e2450be3db55509a
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/4a03796f-a8d4-4293-84ef-d3959456223a