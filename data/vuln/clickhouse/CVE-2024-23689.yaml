info:
  name: clickhouse
  cve: CVE-2024-23689
  summary: ClickHouse客户端异常中客户端证书密码泄露。
  details: |
    当启用受密码保护的客户端证书认证时，密码（sslkey）可能会在客户端异常（例如ClickHouseException或SQLException）中泄露。
    如果异常消息被记录或暴露给未经授权的方，这可能导致未经授权的访问、数据泄露和隐私侵犯。
  cvss: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
  severity: MEDIUM
  security_advise: |
    1. 将ClickHouse客户端库升级到0.4.6或更高版本。
    2. 确保客户端异常日志得到妥善保护，未经授权的人员无法访问。
    3. 审查并限制对任何可能记录或显示客户端异常消息的系统的访问。
rule: version > "0" && version < "0.4.6"
references:
  - https://github.com/ClickHouse/clickhouse-java/security/advisories/GHSA-g8ph-74m6-8m7r
  - https://nvd.nist.gov/vuln/detail/CVE-2024-23689
  - https://github.com/ClickHouse/clickhouse-java/issues/1331
  - https://github.com/ClickHouse/clickhouse-java/pull/1334
  - https://github.com/ClickHouse/clickhouse-java
  - https://github.com/ClickHouse/clickhouse-java/releases/tag/v0.4.6
  - https://vulncheck.com/advisories/vc-advisory-GHSA-g8ph-74m6-8m7r