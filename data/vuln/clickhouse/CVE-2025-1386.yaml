info:
  name: clickhouse
  cve: CVE-2025-1386
  summary: ch-go 库中的查询走私漏洞
  details: |
    在使用 ch-go 库时，特定条件下涉及大量未压缩的恶意外部数据，可使攻击者控制此类数据并将另一个查询包走私到连接流中。这可能导致非预期的查询执行。
    此问题由 lixts 发现并通过 Bugcrowd 计划报告。
  cvss: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
  severity: HIGH
  security_advise: |
    1. 将 ch-go 库升级至版本 >= 0.65.0
    2. 审查外部数据源的网络输入处理逻辑
    3. 对传入的查询流应用严格的解析和验证机制
rule: version >= "0" && version < "0.65.0"
references:
  - https://github.com/ClickHouse/ch-go/security/advisories/GHSA-m454-3xv7-qj85
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1386
  - https://github.com/ClickHouse/ch-go/commit/0e835663df32b09b828528c07a5507686e6d975e
  - https://pkg.go.dev/vuln/GO-2025-3603