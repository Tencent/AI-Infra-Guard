info:
  name: comfyui
  cve: CVE-2024-6673
  summary: lollms-webui ComfyUI 安装端点存在跨站请求伪造（CSRF）漏洞
  details: |
    在 parisneo/lollms-webui 项目的 `lollms_comfyui.py` 文件中的 `install_comfyui` 端点存在一个 CSRF 漏洞，影响从 v9.9 版本到发现时最新版本的所有版本。该端点错误地使用了 GET 方法，并且缺乏客户端 ID 验证等防护机制，使得攻击者可以诱使用户在不知情的情况下触发 ComfyUI 的安装操作。这可能导致受害者设备资源耗尽并引发应用程序崩溃。
  cvss: CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:L
  severity: MEDIUM
  security_advise: |
    1. 避免对状态变更操作使用 GET 方法；应改用 POST 并配合 anti-CSRF token 进行防护。
    2. 对敏感端点实施正确的身份验证和授权检查。
    3. 如有补丁版本请升级至修复版本，或根据所引用的提交手动应用相关修复。
rule: version >= "9.9.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6673
  - https://github.com/parisneo/lollms-webui/commit/c1bb1ad19752aa7541675b398495eaf98fd589f1
  - https://huntr.com/bounties/a38f9a7d-b357-427d-adac-f9654d8c0e3c