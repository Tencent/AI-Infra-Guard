info:
  name: comfyui
  cve: CVE-2026-22777
  summary: ComfyUI-Manager 的配置处理程序中存在 CRLF 注入漏洞。
  details: |
    攻击者可以在 HTTP 查询参数中注入特殊字符，从而向 `config.ini` 文件添加任意配置值，导致安全设置被篡改或应用程序行为被修改。此漏洞影响在 ComfyUI 配置了 `--listen` 选项以允许远程访问的环境中运行 ComfyUI-Manager 的用户。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 ComfyUI-Manager 版本 3.39.2 或 4.0.5。
    2. 如果无法升级，请仅在受信任的网络上运行 ComfyUI-Manager。
    3. 通过防火墙阻止外部访问。
    4. 仅在本地主机上运行，不带 `--listen` 选项。
rule: version < "3.39.2" || (version >= "4.0.0" && version < "4.0.5")
references:
  - https://github.com/Comfy-Org/ComfyUI-Manager/security/advisories/GHSA-562r-8445-54r2
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22777
  - https://cwe.mitre.org/data/definitions/93.html
  - https://owasp.org/www-community/vulnerabilities/CRLF_Injection