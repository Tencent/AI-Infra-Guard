info:
  name: dify
  cve: CVE-2025-56157
  summary: Dify 的 docker-compose.yaml 文件中包含默认凭据，导致未经授权的访问。
  details: |
    Dify（v1.5.1 及以前版本）的漏洞是由于其源代码中 `docker-compose.yaml` 文件包含了默认的 PostgreSQL 用户名和密码。这使得攻击者可以未经授权地访问数据库。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 将 Dify 升级到 v1.5.1 以上的版本，该漏洞已在新版本中得到修复。
    2. 立即将 `docker-compose.yaml` 文件中指定的默认 PostgreSQL 凭据更改为强密码和唯一的密码。
    3. 确保您的 `docker-compose.yaml` 文件和其他配置文件不会公开访问。
rule: version <= "1.5.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-56157
  - https://github.com/langgenius/dify/issues/15285
  - https://github.com/langgenius/dify/pull/15286
  - https://github.com/langgenius/dify/pull/15286.diff
  - https://gist.github.com/Cristliu/216ddbadaf3258498c93d408683ecabd
  - https://gist.github.com/Cristliu/298f51cbc72c45d91632cd0d65aa8161
  - https://github.com/langgenius/dify
  - https://github.com/langgenius/dify/releases/tag/1.0.1
  - http://dify.com