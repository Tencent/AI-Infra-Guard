info:
  name: dify
  cve: CVE-2025-63388
  summary: Dify v1.9.1 存在 CORS 配置错误漏洞，允许未经授权的跨域请求。
  details: |
    Dify v1.9.1 的 `/console/api/system-features` 端点中存在跨域资源共享 (CORS) 配置错误漏洞。
    该端点实施了过于宽松的 CORS 策略，该策略会反映任意 Origin 标头并设置 `Access-Control-Allow-Credentials: true`，
    从而允许任何外部域发出经过身份验证的跨域请求。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. 将 Dify 升级到解决此 CORS 配置错误的版本。
    2. 在 `/console/api/system-features` 端点上实施严格的 CORS 策略，仅允许受信任的源。
    3. 避免反映任意 `Origin` 标头，并确保对于不受信任的源，`Access-Control-Allow-Credentials` 未设置为 `true`。
rule: version == "1.9.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-63388
  - https://gist.github.com/Cristliu/5ded6d03e41d7d66ecb1b568bae3ff6c
  - https://gist.github.com/Cristliu/c2bc7d05abd89db8eb542a453a528d77
  - https://github.com/langgenius/dify/discussions