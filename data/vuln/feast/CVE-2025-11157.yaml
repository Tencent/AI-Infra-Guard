info:
  name: feast
  cve: CVE-2025-11157
  summary: Feast 存在反序列化不受信任数据漏洞，导致远程代码执行。
  details: |
    feast-dev/feast 0.53.0 版本中存在一个高严重性的远程代码执行漏洞，
    具体位于 `feast/sdk/python/feast/infra/compute_engines/kubernetes/main.py` 中的 Kubernetes materializer 作业。
    该漏洞源于使用 `yaml.load(..., Loader=yaml.Loader)` 反序列化
    `/var/feast/feature_store.yaml` 和 `/var/feast/materialization_config.yaml`。此方法允许
    实例化任意 Python 对象，使能够修改这些 YAML 文件的攻击者能够在工作节点 pod 上执行操作系统命令。
    此漏洞可在配置验证之前被利用，可能导致集群被接管、数据投毒和供应链破坏。
  cvss: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. 将 Feast 升级到 0.54.0 或更高版本。
    2. 确保 YAML 配置文件（`/var/feast/feature_store.yaml` 和 `/var/feast/materialization_config.yaml`）
       不可被非受信任用户修改。
    3. 对 Feast 处理的任何配置文件实施严格的访问控制和验证。
rule: version > "0" && version < "0.54.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-11157
  - https://github.com/feast-dev/feast/pull/5643
  - https://github.com/feast-dev/feast/commit/b2e37ff37953b68ae833f6874ab5bc510a4ca5fb
  - https://github.com/feast-dev/feast
  - https://huntr.com/bounties/46d4d585-b968-4a76-80ce-872bc5525564