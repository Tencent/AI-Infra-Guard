info:
  name: jupyter-notebook
  cve: CVE-2025-53000
  summary: nbconvert 存在未受控的搜索路径，导致在 Windows 上执行未经授权的代码。
  details: |
    Windows 系统上 `nbconvert` 中的漏洞允许在将包含 SVG 输出的笔记本转换为 PDF 时执行未经授权的代码。这是由于未受控的搜索路径元素 (CWE-427)，`nbconvert` 在其中搜索 `inkscape` 可执行文件。攻击者可以在当前工作目录中放置一个恶意的 `inkscape.bat` 文件，当运行 `jupyter nbconvert --to pdf` 时，该文件将被执行，从而导致任意代码执行。
  cvss: CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:P/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
  severity: HIGH
  security_advise: |
    1. 将 `nbconvert` 升级到大于 `7.16.6` 的版本。
    2. 避免在 Windows 上不受信任的目录中运行 `jupyter nbconvert --to pdf`。
    3. 确保在系统的 PATH 环境变量中正确配置 `inkscape` 可执行文件，以防止加载恶意脚本。
rule: version > "0" && version <= "7.16.6"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-53000
  - https://github.com/jupyter/nbconvert
  - https://github.com/jupyter/nbconvert/blob/4f61702f5c7524d8a3c4ac0d5fc33a6ac2fa36a7/nbconvert/preprocessors/svg2pdf.py#L104
  - https://www.imperva.com/blog/code-execution-in-jupyter-notebook-exports