info:
  name: langchain
  cve: CVE-2025-58177
  summary: 通过 initialMessages 参数在 n8n LangChain Chat Trigger 节点中存在存储型 XSS 漏洞
  details: |
    在 `@n8n/n8n-nodes-langchain.chatTrigger` 节点中发现一个存储型跨站脚本（XSS）漏洞。
    如果攻击者在 `initialMessages` 字段中配置恶意 JavaScript 并启用公共访问，
    则该脚本将在任何访问公共聊天 URL 的用户浏览器中执行。这可能导致会话劫持、
    敏感数据窃取或钓鱼攻击。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 将 n8n 升级至版本 >=1.107.0
    2. 如不需要，禁用 `n8n-nodes-langchain.chatTrigger` 节点（[文档](https://docs.n8n.io/hosting/securing/blocking-nodes/)）
    3. 对所有用户提供的输入进行清理，特别是用于 UI 渲染的字段如 `initialMessages`
rule: version >= "1.24.0" && version < "1.107.0"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-mvh4-2cm2-6hpg
  - https://nvd.nist.gov/vuln/detail/CVE-2025-58177
  - https://github.com/n8n-io/n8n/pull/18148
  - https://github.com/n8n-io/n8n/commit/d4ef191be0b39b65efa68559a3b8d5dad2e102b2
  - https://docs.n8n.io/hosting/securing/blocking-nodes