info:
  name: langchain
  cve: CVE-2025-68665
  summary: LangChain 序列化注入漏洞导致秘密信息泄露。
  details: |
    LangChain JS 的 `toJSON()` 方法中存在一个序列化注入漏洞，原因是未能正确转义包含 `'lc'` 键的用户控制数据。这允许攻击者注入恶意 LangChain 对象结构，可能导致秘密信息（例如环境变量）泄露或通过攻击者控制的参数实例化任意类。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 `@langchain/core` 升级到 `1.1.8` 或更高版本。
    2. 将 `langchain` 升级到 `1.2.3` 或更高版本。
    3. 如果需要加载秘密信息，请使用 `secretsMap` 明确提供，而不是依赖 `secretsFromEnv: true`。
    4. 仅在明确信任序列化数据时才启用 `secretsFromEnv: true`。
    5. 对于深层嵌套结构，如有必要，请调整 `load()` 中的 `maxDepth` 参数。
    6. 使用自定义导入映射时，请确保它们只包含受信任的模块，绝不从用户输入中填充它们。
rule: (version > "0" && version < "0.3.80") || (version > "1.0.0" && version < "1.1.8") || (version > "0" && version < "0.3.37") || (version > "1.0.0" && version < "1.2.3")
references:
  - https://github.com/langchain-ai/langchainjs/security/advisories/GHSA-r399-636x-v7f6
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68665
  - https://github.com/langchain-ai/langchainjs/commit/e5063f9c6e9989ea067dfdff39262b9e7b6aba62
  - https://github.com/langchain-ai/langchainjs
  - https://github.com/langchain-ai/langchainjs/releases/tag/%40langchain%2Fcore%401.1.8
  - https://github.com/langchain-ai/langchainjs/releases/tag/langchain%401.2.3