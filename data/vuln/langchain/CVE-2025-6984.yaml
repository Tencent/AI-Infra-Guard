info:
  name: langchain
  cve: CVE-2025-6984
  summary: Langchain Community 存在 XML 外部实体（XXE）攻击漏洞
  details: |
    `langchain-community` 包中的 `EverNoteLoader` 组件由于不安全地使用 `etree.iterparse()` 而未禁用外部实体引用，导致容易受到 XML 外部实体（XXE）攻击。攻击者可通过提交恶意 XML 载荷来读取敏感本地文件。该漏洞已在版本 0.3.27 中修复。
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 `langchain-community` 升级至版本 >= 0.3.27
    2. 如果实现了自定义解析逻辑，请检查并清理 XML 输入处理过程
    3. 在文档加载器中应用最小权限原则限制文件访问
rule: version >= "0" && version < "0.3.27"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6984
  - https://github.com/langchain-ai/langchain-community/commit/e842452108089524e22c3a2ced851c021884556f
  - https://github.com/langchain-ai/langchain-community
  - https://github.com/langchain-ai/langchain/blob/d79b5813a0b3b243c612b77013768995e46c4337/libs/langchain/langchain/document_loaders/evernote.py#L1-L23
  - https://huntr.com/bounties/a6b521cf-258c-41c0-9edb-d8ef976abb2a