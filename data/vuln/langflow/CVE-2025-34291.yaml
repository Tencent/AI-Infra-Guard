info:
  name: langflow
  cve: CVE-2025-34291
  summary: Langflow CORS配置错误导致账户劫持和RCE。
  details: |
    Langflow 1.6.9及更早版本存在一个链式漏洞，该漏洞可导致账户劫持和远程代码执行。
    一个过于宽松的CORS配置（allow_origins='*' 且 allow_credentials=True）与配置为SameSite=None的刷新令牌cookie结合，允许恶意网页执行包含凭据的跨域请求，并成功调用刷新端点。
    因此，攻击者控制的源可以为受害者会话获取新的access_token/refresh_token对。
    获取到的令牌允许访问认证端点——包括内置的代码执行功能——从而使攻击者能够执行任意代码并实现完全系统入侵。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 将Langflow升级到1.6.9以上的版本。
    2. 审查并限制CORS配置，仅允许受信任的源。
    3. 确保刷新令牌cookie配置了适当的SameSite策略（例如，`SameSite=Lax` 或 `SameSite=Strict`），以防止跨站点凭据泄露。
rule: version > "0" && version <= "1.6.9"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-34291
  - https://github.com/langflow-ai/langflow/pull/10139
  - https://github.com/langflow-ai/langflow/pull/10696
  - https://github.com/langflow-ai/langflow/pull/9240
  - https://github.com/langflow-ai/langflow/pull/9441
  - https://github.com/langflow-ai/langflow
  - https://www.obsidiansecurity.com/blog/cve-2025-34291-critical-account-takeover-and-rce-vulnerability-in-the-langflow-ai-agent-workflow-platform
  - https://www.vulncheck.com/advisories/langflow-cors-misconfiguration-to-token-hijack-and-rce