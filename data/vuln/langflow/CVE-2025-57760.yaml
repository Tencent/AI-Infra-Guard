info:
  name: langflow
  cve: CVE-2025-57760
  summary: 通过CLI超级用户创建实现的权限提升漏洞存在于Langflow中
  details: |
    在Langflow容器中存在一个权限提升漏洞，攻击者在获得远程代码执行（RCE）访问权限后，可以调用内部CLI命令 `langflow superuser` 来创建一个新的管理员用户。此操作绕过了前端和后端的角色检查机制，从而获取完整的超级用户权限。
    该漏洞产生的原因是 `/app/.venv/bin/langflow` 二进制文件暴露了未根据用户角色进行限制的敏感CLI命令。攻击者如果获得了RCE权限（例如通过 `/api/v1/validate/code` 接口），即可执行以下命令：
    ```
    /app/.venv/bin/langflow superuser
    ```
    此命令将创建一个新的管理员用户，使攻击者能够完全控制Langflow实例，包括访问所有用户数据、流程配置、凭据以及环境变量。
    ### 影响：
    - 完全攻陷Langflow应用程序
    - 非授权访问存储的凭证和API密钥
    - 能够管理或删除其他用户账户
    - 可能通过启动额外实例导致资源耗尽
    ### 漏洞验证步骤（PoC）：
    1. 使用 `LANGFLOW_ENABLE_AUTH=true` 启动容器。
    2. 通过UI界面注册为普通用户。
    3. 利用RCE漏洞建立反向shell连接。
    4. 在容器内执行 `langflow superuser` 命令。
    5. 使用新创建的超级用户身份登录系统。
cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
severity: HIGH
security_advise: |
  1. 升级至Langflow版本 >= 1.5.1（发布后）以应用正确的权限限制措施。
  2. 将 `/api/v1/validate/code` 接口的访问权限仅限于受信任来源。
  3. 禁用或移除生产环境中不必要的CLI可执行文件。
  4. 对正在运行的容器进行审计，查找异常创建的超级用户，并重置所有管理员账户密码。
  5. 实施运行时安全监控机制，检测异常CLI命令使用行为。
rule: version >= "0" && version < "1.5.1"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-4gv9-mp8m-592r
  - https://github.com/langflow-ai/langflow