info:
  name: langflow
  cve: CVE-2025-68477
  summary: Langflow 的 API 请求组件中用户提供的 URL 验证不当，导致其易受服务器端请求伪造 (SSRF) 攻击。
  details: |
    Langflow 的 API 请求组件允许用户在流程中发出任意 HTTP 请求。此组件仅执行基本的 URL 规范化和格式检查，未能阻止私有 IP 范围（例如 127.0.0.1、10.0.0.0/8、172.16.0.0/12、192.168.0.0/16）或云元数据端点（例如 169.254.169.254）。由于流程执行端点只需 API 密钥即可调用，因此能够控制流程中 API 请求 URL 的攻击者可以实现非盲 SSRF。这使得攻击者能够访问内部资源、从管理端点、元数据服务和内部数据库泄露信息，为进一步攻击提供立足点。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 将 Langflow 升级到 1.7.1 或更高版本。
    2. 对所有用户提供的 URL，实施严格的验证和阻止私有 IP 范围以及敏感内部端点。
    3. 确保 API 请求组件不返回内部请求的原始响应正文，以防止非盲 SSRF。
rule: version > "0" && version < "1.7.1"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-5993-7p27-66g5
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68477
  - https://github.com/langflow-ai/langflow