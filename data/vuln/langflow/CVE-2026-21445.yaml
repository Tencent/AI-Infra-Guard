info:
  name: langflow
  cve: CVE-2026-21445
  summary: Langflow 中多个关键 API 端点缺少身份验证控制，允许任何未经身份验证的用户访问敏感的用户对话数据、交易历史记录并执行破坏性操作。
  details: |
    该漏洞存在于 `src/backend/base/langflow/api/v1/monitor.py` 中的三个 API 端点，这些端点缺少所需的身份验证依赖项 `dependencies=[Depends(get_current_active_user)]`。
    
    **受影响的端点：**
    1. **GET `/api/v1/monitor/messages`**：允许未经身份验证访问所有用户对话。
    2. **GET `/api/v1/monitor/transactions`**：允许未经身份验证访问交易历史记录。
    3. **DELETE `/api/v1/monitor/messages/session/{session_id}`**：允许未经身份验证通过会话删除用户消息。
    
    这种不一致性很明显，因为同一文件中的其他端点正确实现了身份验证。攻击者可以利用此漏洞访问敏感数据、侵犯隐私并执行数据销毁。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. 将 `langflow-base` 升级到版本 `0.7.1` 或更高版本。
    2. 将 `langflow` 升级到版本 `1.7.1` 或更高版本。
    3. 确保以下 API 端点已应用 `dependencies=[Depends(get_current_active_user)]` 身份验证依赖项：
        - `@router.get("/messages")`
        - `@router.get("/transactions")`
        - `@router.delete("/messages/session/{session_id}")`
rule: version < "0.7.1"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - https://nvd.nist.gov/vuln/detail/CVE-2026-21445
  - https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
  - https://github.com/langflow-ai/langflow
  - https://github.com/langflow-ai/langflow/releases/tag/1.7.1