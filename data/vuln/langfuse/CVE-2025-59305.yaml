info:
  name: langfuse
  cve: CVE-2025-59305
  summary: 后台迁移端点的授权不当，允许已认证用户调用迁移控制功能。
  details: |
    在 Langfuse 3.1 版本（提交 d67b317）之前，后台迁移端点上的授权控制不当，导致任何已认证用户都可以访问 TRPC 函数，例如 `backgroundMigrations.all`、`backgroundMigrations.status` 和 `backgroundMigrations.retry`。这可能导致数据损坏或通过未授权访问引发拒绝服务。
    此问题源于权限检查不足，使得拥有有效凭证的低权限攻击者可以干扰关键的后端进程。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L
  severity: HIGH
  security_advise: |
    1. 升级到 Langfuse 3.1 或更高版本（提交 d67b317+）。
    2. 审查并限制对 TRPC 后台迁移端点的访问。
    3. 对管理功能实施适当的基于角色的访问控制（RBAC）。
rule: version >= "3.0.0" && version < "3.1.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-59305
  - https://github.com/langfuse/langfuse/pull/9028
  - https://depthfirst.webflow.io/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study