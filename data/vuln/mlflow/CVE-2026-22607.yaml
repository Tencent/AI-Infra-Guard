info:
  name: mlflow
  cve: CVE-2026-22607
  summary: Fickling 版本最高包括 0.1.6 未将 Python 的 `cProfile` 模块视为不安全，导致黑名单绕过和潜在的任意代码执行。
  details: |
    Fickling（版本 <= 0.1.6）中的漏洞产生的原因是，`cProfile` 模块，特别是 `cProfile.run()` 和 `cProfile.runctx()`，未包含在其不安全导入的黑名单中。这一遗漏使得利用 `cProfile.run()` 的恶意 pickle 文件被 Fickling 归类为“可疑”（"SUSPICIOUS"）而非“明显恶意”（"OVERTLY_MALICIOUS"）。因此，依赖 Fickling 输出进行 pickle 安全检查的用户可能会无意中反序列化攻击者控制的代码，导致任意代码执行。这类似于之前涉及 `pty` 和 `marshal/types` 的绕过。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. 将 Fickling 升级到 0.1.7 或更高版本。
    2. 如果不使用最新版本的 Fickling，请确保 `cProfile`、`cProfile.run`、`cProfile.runctx` 和 `_lsprof` 包含在任何自定义的不安全导入黑名单中。
    3. 即使 pickle 文件被安全工具标记为“可疑”，在反序列化来自不受信任来源的 pickle 文件时也要格外小心。
rule: version > "0" && version < "0.1.7"
references:
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-565g-hwwr-4pp3
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-p523-jq9w-64x9
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-r7v6-mfhq-g3m2
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22607
  - https://github.com/trailofbits/fickling/pull/108
  - https://github.com/trailofbits/fickling/pull/187
  - https://github.com/trailofbits/fickling/pull/195
  - https://github.com/trailofbits/fickling/commit/dc8ae12966edee27a78fe05c5745171a2b138d43
  - https://github.com/trailofbits/fickling
  - https://github.com/trailofbits/fickling/blob/977b0769c13537cd96549c12bb537f05464cf09c/test/test_bypasses.py#L116
  - https://github.com/trailofbits/fickling/releases/tag/v0.1.7