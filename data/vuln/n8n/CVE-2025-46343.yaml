info:
  name: n8n
  cve: CVE-2025-46343
  summary: n8n 存在通过附件查看端点实现的存储型XSS漏洞，允许已认证攻击者执行恶意JavaScript。
  details: |
    n8n 工作流可以存储和提供二进制文件，此前对上传文件的 MIME 类型缺乏限制，MIME 类型可以通过 GET 参数控制。这允许服务器响应任何 MIME 类型，可能导致恶意内容被浏览器解释和执行。
    具有成员级别权限的已认证攻击者可以利用这一点，上传一个包含恶意 JavaScript 的精心构造的 HTML 文件。当另一个用户访问二进制数据端点并将 MIME 类型设置为 text/html 时，脚本将在用户会话的上下文中执行，可能导致账户被接管。
  cvss: CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. 将 n8n 升级到 1.90.0 或更高版本。
rule: version > "0" && version < "1.90.0"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-c8hm-hr8h-5xjw
  - https://nvd.nist.gov/vuln/detail/CVE-2025-46343
  - https://github.com/n8n-io/n8n/pull/14350
  - https://github.com/n8n-io/n8n/pull/14685
  - https://github.com/n8n-io/n8n
  - https://github.com/n8n-io/n8n/releases/tag/n8n%401.90.0