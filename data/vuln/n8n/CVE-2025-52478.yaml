info:
  name: n8n
  cve: CVE-2025-52478
  summary: n8n 表单触发器中存在存储型 XSS 漏洞，可通过注入 iframe 和 video/source 导致账户劫持。
  details: |
    n8n 表单触发器节点中的 HTML 表单元素存在存储型跨站脚本 (XSS) 漏洞。
    经过身份验证的攻击者可以通过带有 `srcdoc` 有效载荷的 `<iframe>` 或
    结合使用 `onerror` 事件的 `<video>` 标签和 `<source>` 标签来注入恶意 HTML。这可能导致账户劫持 (ATO)，
    通过窃取已通过身份验证用户的 `n8n-browserId` 和会话 cookie，从而实现冒充和
    修改账户详细信息。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 n8n 版本 >=1.98.2。
    2. 配置反向代理，使其从不同的域提供 Webhook 请求。
    3. 禁用或限制使用表单触发器节点，特别是 HTML 元素类型。
    4. 实施内容安全策略 (CSP) 以阻止内联脚本并禁止 `srcdoc`。
rule: version >= "1.77.0" && version < "1.98.2"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - https://nvd.nist.gov/vuln/detail/CVE-2025-52478
  - https://github.com/n8n-io/n8n/pull/16329
  - https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
  - https://github.com/n8n-io/n8n
  - https://cheatsheetseries.owasp.org/cheatsheets/XSS_Prevention_Cheat_Sheet.html
  - https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-srcdoc
  - https://html.spec.whatwg.org/multipage/webappapis.html#handler-onerror