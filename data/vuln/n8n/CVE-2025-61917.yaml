info:
  name: n8n
  cve: CVE-2025-61917
  summary: n8n 的不安全缓冲区分配导致任务运行器中发生进程内内存泄露。
  details: |
    n8n 中的漏洞源于任务运行器中使用了 `Buffer.allocUnsafe()` 和 `Buffer.allocUnsafeSlow()`，这允许不受信任的代码分配未初始化的内存。这可能通过暴露来自同一 Node.js 进程的残留数据（例如来自先前请求、任务、秘密或令牌的数据）而导致信息泄露。此问题影响启用了任务运行器 (`N8N_RUNNERS_ENABLED=true`) 且启用了代码节点部署。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. 尽快升级到 n8n 版本 >= 1.114.3 或 1.115.0。
    2. 如果无法立即升级，请通过将 `n8n-nodes-base.code` 添加到 `NODES_EXCLUDE` 环境变量来禁用代码节点。
    3. 通过在外部模式下运行任务运行器来优先采用外部模式进行隔离，这会在单独的 sidecar 容器中执行不受信任的任务代码，从而降低进程内内存泄露的风险。
rule: version > "1.65.0" && version < "1.114.3"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-49mx-fj45-q3p6
  - https://nvd.nist.gov/vuln/detail/CVE-2025-61917
  - https://github.com/n8n-io/n8n/commit/2c4c2953199733c791f739a40879ae31ca129aba
  - https://github.com/n8n-io/n8n
  - https://nodejs.org/docs/latest-v22.x/api/buffer.html#static-method-bufferallocsize-fill-encoding
  - https://nodejs.org/docs/latest-v22.x/api/buffer.html#static-method-bufferallocunsafesize
  - https://docs.n8n.io/hosting/configuration/task-runners/
  - https://docs.n8n.io/hosting/securing/blocking-nodes/