info:
  name: n8n
  cve: CVE-2025-65964
  summary: n8n 存在通过 Git 节点自定义 Pre-Commit 钩子实现远程代码执行漏洞。
  details: |
    n8n Git 节点允许工作流设置任意 Git 配置值，包括 `core.hooksPath`。
    攻击者控制的工作流可以将此路径设置为克隆仓库中包含 Git 钩子（例如，`pre-commit`）的目录，从而导致在 n8n 主机上执行任意命令。
    成功利用需要能够创建或修改使用 Git 节点的 n8n 工作流。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 n8n 版本 1.119.2 或更高版本。
    2. 如果无法立即升级，请排除 Git 节点。
    3. 避免使用 Git 节点克隆或与不受信任的仓库进行交互。
rule: version >= "0.123.1" && version < "1.119.2"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-wpqc-h9wp-chmq
  - https://nvd.nist.gov/vuln/detail/CVE-2025-65964
  - https://github.com/n8n-io/n8n/commit/d5a1171f95f75def5c3ac577707ab913e22aef04
  - https://github.com/n8n-io/n8n
  - https://github.com/n8n-io/n8n/releases/tag/n8n%401.119.2
  - https://n8n-docs.teamlab.info/hosting/securing/blocking-nodes/#exclude-nodes