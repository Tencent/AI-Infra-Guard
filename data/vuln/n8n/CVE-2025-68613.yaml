info:
  name: n8n
  cve: CVE-2025-68613
  summary: n8n 存在通过表达式注入实现远程代码执行的漏洞，允许经过身份验证的攻击者执行任意代码。
  details: |
    n8n 的工作流表达式评估系统存在一个严重的远程代码执行（RCE）漏洞。在某些条件下，经过身份验证的用户在工作流配置期间提供的表达式可能在执行上下文中进行评估，而该上下文与底层运行时隔离不足。
    经过身份验证的攻击者可以滥用此行为，以 n8n 进程的权限执行任意代码。成功利用可能导致受影响实例的完全受损，包括未经授权访问敏感数据、修改工作流以及执行系统级操作。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 n8n v1.122.0 或更高版本。
    2. 如果无法立即升级，请将工作流创建和编辑权限仅限于完全受信任的用户。
    3. 将 n8n 部署在具有受限操作系统权限和网络访问的强化环境中。
rule: version >= "0.211.0" && version < "1.120.4" || version >= "1.121.0" && version < "1.121.1"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68613
  - https://github.com/n8n-io/n8n/commit/08f332015153decdda3c37ad4fcb9f7ba13a7c79
  - https://github.com/n8n-io/n8n/commit/1c933358acef527ff61466e53268b41a04be1000
  - https://github.com/n8n-io/n8n/commit/39a2d1d60edde89674ca96dcbb3eb076ffff6316
  - https://github.com/n8n-io/n8n