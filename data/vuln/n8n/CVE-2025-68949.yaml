info:
  name: n8n
  cve: CVE-2025-68949
  summary: n8n 的 Webhook 节点 IP 白名单绕过漏洞，通过部分字符串匹配允许攻击者绕过 IP 限制。
  details: |
    Webhook 节点的 IP 白名单验证执行的是部分字符串匹配，而非精确的 IP 比较。
    因此，如果传入请求的源 IP 地址仅包含配置的白名单条目作为子字符串，则该请求可能会被接受。
    此问题影响了工作流编辑者依赖基于 IP 的访问控制来限制 Webhook 访问的实例，对 IPv4 和 IPv6 地址均有影响。
    如果攻击者的非白名单 IP 与受信任地址共享部分前缀，则可以绕过限制，从而破坏预期的安全边界。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到 n8n 2.2.0 或更高版本，其中 IP 白名单验证使用严格的 IP 比较逻辑。
    2. 如果无法立即升级，请避免仅依靠 IP 白名单进行 Webhook 安全防护。
    3. 实施额外的身份验证机制，例如共享密钥、HMAC 签名或 API 密钥。
    4. 避免使用短的或基于前缀的白名单条目。
    5. 在网络层强制执行 IP 过滤（例如，通过反向代理或防火墙）。
rule: version > "1.36.0" && version < "2.2.0"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-w96v-gf22-crwp
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68949
  - https://github.com/n8n-io/n8n/issues/23399
  - https://github.com/n8n-io/n8n/pull/23399
  - https://github.com/n8n-io/n8n/commit/11f8597d4ad69ea3b58941573997fdbc4de1fec5
  - https://github.com/n8n-io/n8n