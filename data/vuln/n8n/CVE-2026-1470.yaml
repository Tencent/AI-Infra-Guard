info:
  name: n8n
  cve: CVE-2026-1470
  summary: n8n 的工作流表达式评估系统存在一个严重的远程代码执行（RCE）漏洞。
  details: |
    n8n 的工作流表达式评估系统存在一个严重的远程代码执行（RCE）漏洞。
    经身份验证的用户在工作流配置期间提供的表达式，可能在一个未与底层运行时充分隔离的执行环境中被评估。
    经过身份验证的攻击者可以滥用此行为，以 n8n 进程的权限执行任意代码。
    成功利用可能导致受影响实例的完全受损，包括未经授权地访问敏感数据、修改工作流以及执行系统级操作。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 将 n8n 升级到 1.123.17 或更高版本。
    2. 如果使用 n8n 2.x，请升级到 2.4.5 或更高版本。
    3. 如果使用 n8n 2.5.x，请升级到 2.5.1 或更高版本。
    4. 确保只有受信任且经过身份验证的用户才能访问和配置工作流。
rule: (version > "0" && version < "1.123.17") || (version >= "2.0.0" && version < "2.4.5") || (version >= "2.5.0" && version < "2.5.1")
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2026-1470
  - https://github.com/n8n-io/n8n/commit/25c4b9605b420a98d0185a4f01115122a5134d8f
  - https://github.com/n8n-io/n8n/commit/30383d86139f3279a698df8d229eadfefe8627f4
  - https://github.com/n8n-io/n8n/commit/aa4d1e5825829182afa0ad5b81f602638f55fa04
  - https://github.com/n8n-io/n8n
  - https://research.jfrog.com/vulnerabilities/n8n-expression-node-rce