info:
  name: n8n
  cve: CVE-2026-21894
  summary: n8n 的 Stripe 触发器节点由于缺少签名验证，易受未经身份验证的伪造 Webhook 攻击。
  details: |
    Stripe 触发器节点中的身份验证绕过漏洞允许未经身份验证的各方通过发送伪造的 Stripe Webhook 事件来触发工作流。Stripe 触发器创建并存储 Stripe Webhook 签名密钥，但传入请求未针对此密钥进行验证。这使得任何知道 Webhook URL 的 HTTP 客户端都可以发送带有匹配事件 `type` 的 POST 请求，从而导致工作流执行，就像收到了合法的 Stripe 事件一样。
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S/U/C:L/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级到 n8n 版本 2.2.2 或更高版本，以确保正确的 Stripe Webhook 签名验证。
    2. 作为临时缓解措施，停用受影响的工作流，或仅限制受信任用户访问包含 Stripe 触发器节点的工作流。
rule: version > "0.150.0" && version < "2.2.2"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-jf52-3f2h-h9j5
  - https://nvd.nist.gov/vuln/detail/CVE-2026-21894
  - https://github.com/n8n-io/n8n/pull/22764
  - https://github.com/n8n-io/n8n/commit/a61a5991093c41863506888336e808ac1eff8d59
  - https://github.com/n8n-io/n8n