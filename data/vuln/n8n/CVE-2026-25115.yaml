info:
  name: n8n
  cve: CVE-2026-25115
  summary: 经身份验证的用户可以在 n8n 的 Python 代码节点中逃逸 Python 沙箱。
  details: |
    Python 代码节点中存在一个漏洞，允许经身份验证的用户突破 Python 沙箱环境，并在预期的安全边界之外执行代码。此问题会影响已启用任务运行器 (`N8N_RUNNERS_ENABLED=true`)、已启用 Python (`N8N_PYTHON_ENABLED=true`) 且已启用代码节点 (`Code Node`) 的部署。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级到 n8n 2.4.8 或更高版本。
    2. 如果无法立即升级，请通过将 `n8n-nodes-base.code` 添加到 `NODES_EXCLUDE` 环境变量来禁用代码节点。
    3. 优先使用任务运行器的外部模式 (`N8N_RUNNERS_MODE=external`)，以便在单独的 sidecar 容器中隔离不受信任的任务代码，从而降低进程内内存泄露的风险。
rule: version > "0" && version < "2.4.8"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-8398-gmmx-564h
  - https://nvd.nist.gov/vuln/detail/CVE-2026-25115
  - https://github.com/n8n-io/n8n/commit/5c69970acc7d37049deae67da861f92d2aaa9b03
  - https://github.com/n8n-io/n8n
  - https://docs.n8n.io/hosting/configuration/task-runners/
  - https://docs.n8n.io/hosting/securing/blocking-nodes/