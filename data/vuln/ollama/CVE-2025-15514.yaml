info:
  name: ollama
  cve: CVE-2025-15514
  summary: Ollama 在多模态图像处理中存在空指针解引用漏洞，导致拒绝服务。
  details: |
    Ollama 版本 0.11.5-rc0 到 0.13.5 在多模态模型图像处理功能中包含一个空指针解引用漏洞。当通过 `/api/chat` 端点处理 base64 编码的图像数据时，应用程序未能验证解码后的数据是否代表有效媒体，就将其传递给 `mtmd_helper_bitmap_init_from_buf` 函数。对于格式错误输入，此函数可能返回 NULL，但代码在后续操作中解引用指针之前未检查此返回值。远程攻击者可以通过发送特制的 base64 图像数据来利用此漏洞，该数据解码为无效媒体，导致分段错误并使运行进程崩溃。这导致拒绝服务条件，模型对所有用户都不可用，直到服务重新启动。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将 Ollama 升级到解决此漏洞的版本。
    2. 对 base64 编码的图像数据实施严格的输入验证，以确保在处理之前它代表有效媒体。
    3. 确保对 `mtmd_helper_bitmap_init_from_buf` 等函数的返回值进行适当的空指针检查。
rule: version >= "0.11.5-rc0" && version <= "0.13.5"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-15514
  - https://https://github.com/ollama/ollama
  - https://huntr.com/bounties/172df98b-07cd-41ea-a628-366f8cd525c0
  - https://ollama.com
  - https://www.vulncheck.com/advisories/ollama-multi-modal-image-processing-null-pointer-dereference