info:
  name: ollama
  cve: CVE-2025-51471
  summary: Ollama 中的跨域令牌暴露
  details: |
    Ollama 0.6.7 版本中的 `server.auth.getAuthorizationToken` 存在漏洞，允许远程攻击者
    窃取身份验证令牌并绕过访问控制。当 `/api/pull` 端点返回包含恶意构造的 realm 值的
    `WWW-Authenticate` 头时，就会发生此问题。
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. 升级到 ollama 版本 >= 0.9.7 以缓解该漏洞。
    2. 对 WWW-Authenticate 头实施严格验证。
    3. 审查并限制 CORS 策略，防止跨域令牌泄露。
rule: version >= "0.6.7" && version < "0.9.7"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51471
  - https://github.com/ollama/ollama/pull/10750
  - https://github.com/ollama/ollama
  - https://www.gecko.security/blog/cve-2025-51471