info:
  name: pyload-ng
  cve: CVE-2025-53890
  summary: pyLoad 存在跨站脚本（XSS）漏洞，可能通过不安全的 CAPTCHA 处理导致远程代码执行（RCE）
  details: |
    pyLoad 的 CAPTCHA 处理代码中存在不安全的 JavaScript 执行漏洞，该漏洞源于对未经净化的用户输入直接使用了 `eval()` 函数。这使得未经身份验证的远程攻击者能够在客户端浏览器中注入并执行任意 JavaScript 代码，并根据运行环境的不同，可能导致后端服务器命令执行。
    漏洞函数示例：
    ```javascript
    function onCaptchaResult(result) {
        eval(result); // 直接执行攻击者可控的输入
    }
    ```
    攻击者无需认证或用户交互即可发起攻击。可通过向以下路径发送构造好的 POST 请求来利用此漏洞：
    ```
    /interactive/captcha
    ```
    示例 PoC：
    ```bash
    curl -X POST "http://localhost:8000/interactive/captcha" \
      -d "cid=123&response=1%3Balert(document.cookie)"
    ```
    此漏洞可被用于会话劫持、凭证窃取，甚至完全的远程代码执行。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. 升级至 pyload-ng 版本 0.20 或更高版本。
    2. 避免使用早于提交 909e5c97885237530d1264cfceb5555870eb9546 的旧版本。
    3. 对所有用户输入进行严格过滤和净化，特别是传入到 JavaScript 上下文中的数据。
    4. 使用更安全的方式替代 `eval()`，例如 JSON 解析或者沙箱执行机制。
rule: version >= "0" && version < "0.20"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-8w3f-4r8f-pf53
  - https://nvd.nist.gov/vuln/detail/CVE-2025-53890
  - https://github.com/pyload/pyload/pull/4586
  - https://github.com/pyload/pyload/commit/909e5c97885237530d1264cfceb5555870eb9546
  - https://github.com/pyload/pyload