info:
  name: pyload-ng
  cve: CVE-2025-57751
  summary: pyLoad CNL Blueprint 中的拒绝服务漏洞，源于 dukpy.evaljs 的使用
  details: |
    该漏洞存在于 pyLoad CNL Blueprint 的 `flash/addcrypted2` 接口中，其中 `jk` 参数未经适当清理或验证就被直接用于调用 `dukpy.evaljs()`。这使得攻击者可以提交任意 JavaScript 代码以消耗大量 CPU 资源，从而导致拒绝服务状况。
    受影响的代码片段：
    ```python
    @bp.route("/flash/addcrypted2", methods=["POST"], endpoint="addcrypted2")
    @local_check
    def addcrypted2():
        ...
        jk = flask.request.form["jk"]
        ...
        jk = eval_js(f"{jk} f()")
    ```
    当与 `dukpy.evaljs` 结合使用时，会导致完整的 CPU 耗尽，如所提供的 PoC 所示。
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. 升级至 `pyload-ng` 版本 >=0.5.0b3.dev92。
    2. 避免将未经清理的用户输入传递给诸如 `dukpy.evaljs` 的 JavaScript 执行函数。
    3. 对所有来自不可信来源的参数实施严格的输入验证和清理措施。
rule: version >= "0" && version < "0.5.0b3.dev92"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-9gjj-6gj7-c4wj
  - https://nvd.nist.gov/vuln/detail/CVE-2025-57751
  - https://github.com/pyload/pyload