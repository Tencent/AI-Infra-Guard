info:
  name: pyload-ng
  cve: CVE-2025-7346
  summary: 未经身份验证的攻击者可绕过本地主机限制，在 pyLoad 中创建任意包
  details: |
    该漏洞允许任何未经身份验证的攻击者通过将 `Host` 头设置为 `127.0.0.1:9666` 来绕过本地主机限制。这使得攻击者可以未授权访问受保护的端点，例如只应由本地或已认证用户访问的 `/flash/add`。
    根本原因在于 `local_check` 中间件错误地基于 `HTTP_HOST` 环境变量来验证传入请求的来源。在 CNL 蓝图中存在一个体现此缺陷逻辑的例子，其中路由保护可通过操纵 HTTP 头部被绕过。
    概念验证演示了通过被绕过的端点成功注入一个包的过程，证实了远程执行未经授权操作的风险，而无需进行身份验证。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. 升级至包含修复的安全版本，即提交 f4e2d12416ba2dfac7b036d5c8d6dab5461b9840 之后的 pyload-ng 版本
    2. 对用于访问控制决策的 HTTP 头部实施更严格的输入验证
    3. 使用防火墙规则或反向代理配置，限制 Web UI 的网络暴露范围到可信源
rule: version <= "0.5.0b3.dev88"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-x698-5hjm-w2m5
  - https://github.com/pyload/pyload/commit/f4e2d12416ba2dfac7b036d5c8d6dab5461b9840
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L21-L36
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L56-L58C11