info:
  name: ragflow
  cve: CVE-2025-51462
  summary: RAGFlow中的存储型XSS漏洞允许通过未过滤输入执行远程代码
  details: |
    在RAGFlow 0.17.2版本的`api.apps.dialog_app.set_dialog`函数中存在一个存储型跨站脚本（XSS）漏洞。
    远程攻击者可以通过向助手问候字段提交特制输入来注入任意JavaScript代码。
    此输入未经清理即被存储，并在后续使用带有`rehype-raw`插件的markdown组件进行渲染，
    当内容显示时将导致客户端脚本执行。
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: HIGH
  security_advise: |
    1. 升级到已修复输入清理问题的RAGFlow版本
    2. 对所有用户提供的数据在渲染前实施严格的输出编码
    3. 避免在不可信输入上使用如`rehype-raw`等原始HTML渲染库
rule: version == "0.17.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51462
  - https://github.com/infiniflow/ragflow/pull/7250
  - https://github.com/infiniflow/ragflow
  - https://www.gecko.security/blog/cve-2025-51462