info:
  name: vllm
  cve: CVE-2025-32381
  summary: xgrammar 存在拒绝服务漏洞，源于缓存内存使用无上限
  details: |
    vLLM 中使用的 xgrammar 库实现了已编译语法的缓存机制以提升性能。然而该缓存未做容量限制，攻击者可通过发送大量包含不同 JSON 模式的请求来耗尽系统内存，从而导致拒绝服务。
    此问题已在 xgrammar 0.1.18 版本中通过引入有界缓存大小得到修复。在 vLLM 中集成此修复的一个示例可见于 PR #16283。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将 `xgrammar` 依赖升级至版本 >= 0.1.18
    2. 如果使用自定义语法缓存，请对缓存实现大小限制
    3. 对暴露给不可信输入的 LLM 推理服务监控资源使用情况
rule: version >= "0" && version < "0.1.18"
references:
  - https://github.com/mlc-ai/xgrammar/security/advisories/GHSA-389x-67px-mjg3
  - https://nvd.nist.gov/vuln/detail/CVE-2025-32381
  - https://github.com/mlc-ai/xgrammar/pull/243
  - https://github.com/vllm-project/vllm/pull/16283
  - https://github.com/mlc-ai/xgrammar