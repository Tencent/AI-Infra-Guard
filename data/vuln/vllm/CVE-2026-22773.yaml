info:
  name: vllm
  cve: CVE-2026-22773
  summary: vLLM 在 Idefics3 视觉模型中存在拒绝服务漏洞，该漏洞通过具有模糊尺寸的图像负载触发。
  details: |
    该漏洞允许攻击者通过发送特制的 1x1 像素图像来使服务多模态模型（使用 Idefics3 视觉模型实现）的 vLLM 引擎崩溃。这会导致张量维度不匹配和未处理的运行时错误，从而导致服务器完全终止。该问题源于图像处理器错误地解释了图像格式（HWC 与 CHW），导致图像补丁计算不正确以及致命的张量拆分操作失败。
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. 将 vLLM 升级到 0.12.0 或更高版本。
    2. 对图像尺寸实施输入验证，以防止处理小于定义最小尺寸的图像。
    3. 在图像处理函数周围实施鲁棒的异常处理，以捕获和管理 `RuntimeError` 异常，防止服务器崩溃。
rule: version > "0.6.4" && version < "0.12.0"
references:
  - https://github.com/vllm-project/vllm/security/advisories/GHSA-grg2-63fw-f2qr
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22773
  - https://github.com/vllm-project/vllm/pull/29881
  - https://github.com/vllm-project/vllm/commit/0ec84221718d920c3f46da879cc354f94b8fb59e
  - https://github.com/vllm-project/vllm