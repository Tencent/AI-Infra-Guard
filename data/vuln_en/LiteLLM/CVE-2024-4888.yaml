info:
  name: LiteLLM
  cve: CVE-2024-4888
  summary: Arbitrary file deletion due to improper input validation in LiteLLM
  details: |
    The `/audio/transcriptions` endpoint in LiteLLM is vulnerable to arbitrary file deletion caused by insufficient input validation.
    An attacker can send a specially crafted request containing a file path, which leads to unauthorized deletion of files on the server.
    This can result in the loss of critical system files such as SSH keys, databases, or configuration files.
    The issue arises from unsafe usage of `os.remove(file.filename)` without validating the file path.
  cvss: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:N/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade to LiteLLM version 1.35.36 or later.
    2. Implement strict input validation for all user-supplied file paths.
    3. Sanitize and restrict access to filesystem operations within API endpoints.
rule: version >= "0" && version < "1.35.36"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-4888
  - https://github.com/BerriAI/litellm/pull/3193
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/48461d89-cf13-4ad3-a43e-0d37da08fc6c