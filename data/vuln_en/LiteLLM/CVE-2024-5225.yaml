info:
  name: LiteLLM
  cve: CVE-2024-5225
  summary: SQL injection vulnerability in LiteLLM's /global/spend/logs endpoint
  details: |
    An SQL Injection vulnerability exists in the `berriai/litellm` repository within the `/global/spend/logs` endpoint.
    The issue is caused by improper neutralization of special elements in the `api_key` parameter, which is directly 
    concatenated into an SQL query without validation. This allows attackers with low privileges to inject malicious SQL,
    potentially leading to unauthorized data access, manipulation, information disclosure, and denial of service.
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to LiteLLM version 1.40.0 or later.
    2. Sanitize and validate all user-supplied input, especially parameters used in database queries.
    3. Use parameterized queries or ORM methods to prevent direct string concatenation in SQL statements.
rule: version >= "0" && version < "1.40.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-5225
  - https://github.com/BerriAI/litellm/pull/3940
  - https://github.com/BerriAI/litellm/commit/f75c15d6cd535aa78014378ad532de1df6be2f56
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/491e4884-0306-4cd4-8fe2-9a19de33bf5c