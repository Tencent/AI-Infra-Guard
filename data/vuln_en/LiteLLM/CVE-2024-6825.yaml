info:
  name: LiteLLM
  cve: CVE-2024-6825
  summary: Remote Code Execution (RCE) vulnerability in LiteLLM due to insecure handling of callback functions
  details: |
    In LiteLLM versions 1.40.3.dev2 through 1.40.12, the application improperly handles the 'post_call_rules' configuration. An attacker can specify a system method such as 'os.system' as a callback by manipulating the function path. The application splits the provided value at the final '.', treats the suffix as a function name, and imports the prefix with a '.py' extension. This allows arbitrary command execution when the chat response is processed.
  cvss: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to a patched version of LiteLLM (version > 1.40.12).
    2. Avoid using untrusted input in 'post_call_rules'.
    3. Sanitize and validate all user-controlled paths used for dynamic code loading.
rule: version >= "1.40.3.dev2" && version <= "1.40.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6825
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/056913fd7049923a106130b02d7c29e7f312beec/litellm/utils.py#L2818
  - https://huntr.com/bounties/1d98bebb-6cf4-46c9-87c3-d3b1972973b5