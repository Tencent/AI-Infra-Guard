info:
  name: LiteLLM
  cve: CVE-2024-8984
  summary: Denial of Service (DoS) vulnerability via crafted HTTP request in LiteLLM
  details: |
    A Denial of Service (DoS) vulnerability was identified in LiteLLM version v1.44.5. 
    The issue arises when an attacker appends characters such as dashes (-) to the end of a multipart boundary in an HTTP request.
    This causes the server to enter a continuous processing loop, consuming excessive resources and ultimately making the service unavailable.
    The vulnerability is unauthenticated and affects all users of the service without requiring any user interaction.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade LiteLLM to version 1.56.2 or later.
    2. Implement input validation for multipart boundaries to prevent malformed data from triggering resource exhaustion.
    3. Monitor incoming HTTP requests for unusual patterns that may indicate exploitation attempts.
rule: version >= "1.44.5" && version < "1.56.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-8984
  - https://github.com/BerriAI/litellm/commit/4f49f836aa844ac9b6bfbeff27e6f6b2b9cf3f61
  - https://github.com/BerriAI/litellm
  - https://github.com/BerriAI/litellm/blob/8c5ff150f6142608ffe968e4e68429f978fda187/litellm/tests/test_spend_logs.py#L242
  - https://huntr.com/bounties/554fc76b-3097-4223-b4cf-110b853e9355