info:
  name: LiteLLM
  cve: CVE-2024-9606
  summary: LiteLLM leaks portion of API key via logging file due to insufficient masking
  details: |
    In versions of LiteLLM prior to 1.44.12, the `litellm_logging.py` file contained a vulnerability where 
    only the first 5 characters of an API key were masked in logs. This exposed nearly the full API key, 
    significantly compromising its secrecy and increasing the risk of unauthorized access to sensitive services.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to LiteLLM version 1.44.12 or later.
    2. Review existing log files for any exposed API keys and rotate them immediately.
    3. Implement stricter log filtering mechanisms to prevent future leakage of secrets.
rule: version >= "0" && version < "1.44.12"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-9606
  - https://github.com/berriai/litellm/commit/9094071c4782183e84f10630e2450be3db55509a
  - https://github.com/BerriAI/litellm
  - https://huntr.com/bounties/4a03796f-a8d4-4293-84ef-d3959456223a