info:
  name: clickhouse
  cve: CVE-2024-23689
  summary: ClickHouse client certificate password exposure in client exceptions.
  details: |
    When client certificate authentication is enabled with password protection, the password (sslkey)
    may be exposed in client exceptions (e.g., ClickHouseException or SQLException). This can lead
    to unauthorized access, data breaches, and privacy violations if exception messages are logged
    or exposed to unauthorized parties.
  cvss: CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
  severity: MEDIUM
  security_advise: |
    1. Upgrade ClickHouse client libraries to version 0.4.6 or later.
    2. Ensure that client exception logs are properly secured and not accessible to unauthorized individuals.
    3. Review and restrict access to any systems that might log or display client exception messages.
rule: version > "0" && version < "0.4.6"
references:
  - https://github.com/ClickHouse/clickhouse-java/security/advisories/GHSA-g8ph-74m6-8m7r
  - https://nvd.nist.gov/vuln/detail/CVE-2024-23689
  - https://github.com/ClickHouse/clickhouse-java/issues/1331
  - https://github.com/ClickHouse/clickhouse-java/pull/1334
  - https://github.com/ClickHouse/clickhouse-java
  - https://github.com/ClickHouse/clickhouse-java/releases/tag/v0.4.6
  - https://vulncheck.com/advisories/vc-advisory-GHSA-g8ph-74m6-8m7r