info:
  name: clickhouse
  cve: CVE-2025-1386
  summary: Query smuggling vulnerability in ch-go library
  details: |
    When using the ch-go library, a specific condition involving large, uncompressed malicious external data allows an attacker controlling such data to smuggle another query packet into the connection stream. This can lead to unintended query execution.
    The issue was identified by lixts and reported through the Bugcrowd program.
  cvss: CVSS:4.0/AV:N/AC:H/AT:N/PR:H/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N
  severity: HIGH
  security_advise: |
    1. Upgrade the ch-go library to version >= 0.65.0
    2. Review network input handling for external data sources
    3. Apply strict parsing and validation on incoming query streams
rule: version >= "0" && version < "0.65.0"
references:
  - https://github.com/ClickHouse/ch-go/security/advisories/GHSA-m454-3xv7-qj85
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1386
  - https://github.com/ClickHouse/ch-go/commit/0e835663df32b09b828528c07a5507686e6d975e
  - https://pkg.go.dev/vuln/GO-2025-3603