info:
  name: clickhouse
  cve: CVE-2025-1520
  summary: PostHog Plugin Server SQL Injection Leading to Remote Code Execution
  details: |
    A SQL injection vulnerability exists in the PostHog Plugin Server due to insufficient validation of user-supplied input used in SQL query construction. This affects systems using ClickHouse as a backend. Attackers with authenticated access can exploit this flaw to execute arbitrary code in the context of the database account. The issue is tracked as ZDI-CAN-25350.
  cvss: CVSS:3.0/AV:A/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade @posthog/plugin-server to version 1.10.8 or later.
    2. Review and sanitize all user inputs used in dynamic SQL queries.
    3. Apply principle of least privilege for database accounts.
rule: version >= "0" && version < "1.10.8"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-1520
  - https://github.com/PostHog/posthog/commit/6e8f035f9acd339c5ba87ba6ea40fc1ab3053d42
  - https://github.com/PostHog/plugin-server
  - https://www.zerodayinitiative.com/advisories/ZDI-25-099