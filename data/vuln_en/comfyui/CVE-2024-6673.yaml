info:
  name: comfyui
  cve: CVE-2024-6673
  summary: Cross-Site Request Forgery (CSRF) vulnerability in lollms-webui ComfyUI installation endpoint
  details: |
    A CSRF vulnerability exists in the `install_comfyui` endpoint of the `lollms_comfyui.py` file in parisneo/lollms-webui, affecting versions from v9.9 up to the latest at the time of discovery. The endpoint improperly uses the GET method and lacks protection such as client ID verification, making it possible for attackers to trick users into unknowingly triggering ComfyUI installations. This can lead to resource exhaustion and application crashes on victims' devices.
  cvss: CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:L
  severity: MEDIUM
  security_advise: |
    1. Avoid using GET methods for state-changing operations; switch to POST with anti-CSRF tokens.
    2. Implement proper authentication and authorization checks for sensitive endpoints.
    3. Upgrade to a patched version if available or apply manual fixes based on the commit referenced.
rule: version >= "9.9.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-6673
  - https://github.com/parisneo/lollms-webui/commit/c1bb1ad19752aa7541675b398495eaf98fd589f1
  - https://huntr.com/bounties/a38f9a7d-b357-427d-adac-f9654d8c0e3c