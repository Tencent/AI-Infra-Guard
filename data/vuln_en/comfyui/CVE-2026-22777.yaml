info:
  name: comfyui
  cve: CVE-2026-22777
  summary: ComfyUI-Manager is vulnerable to CRLF Injection in its configuration handler.
  details: |
    An attacker can inject special characters into HTTP query parameters to add arbitrary configuration values to the `config.ini` file, leading to security setting tampering or modification of application behavior. This vulnerability affects users running ComfyUI-Manager in environments where ComfyUI is configured with the `--listen` option to allow remote access.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to ComfyUI-Manager version 3.39.2 or 4.0.5.
    2. If upgrading is not possible, run ComfyUI-Manager only on trusted networks.
    3. Block external access via a firewall.
    4. Run on localhost only without the `--listen` option.
rule: version < "3.39.2" || (version >= "4.0.0" && version < "4.0.5")
references:
  - https://github.com/Comfy-Org/ComfyUI-Manager/security/advisories/GHSA-562r-8445-54r2
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22777
  - https://cwe.mitre.org/data/definitions/93.html
  - https://owasp.org/www-community/vulnerabilities/CRLF_Injection