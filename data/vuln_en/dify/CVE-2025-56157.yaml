info:
  name: dify
  cve: CVE-2025-56157
  summary: Dify contains default credentials in its docker-compose.yaml file, allowing unauthorized access.
  details: |
    The vulnerability in Dify (through version 1.5.1) is due to the inclusion of default PostgreSQL username and password within the `docker-compose.yaml` file in its source code. This allows attackers to gain unauthorized access to the database.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade Dify to a version beyond 1.5.1, where this vulnerability is patched.
    2. Immediately change the default PostgreSQL credentials specified in the `docker-compose.yaml` file to strong, unique passwords.
    3. Ensure that your `docker-compose.yaml` file and other configuration files are not publicly accessible.
rule: version <= "1.5.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-56157
  - https://github.com/langgenius/dify/issues/15285
  - https://github.com/langgenius/dify/pull/15286
  - https://github.com/langgenius/dify/pull/15286.diff
  - https://gist.github.com/Cristliu/216ddbadaf3258498c93d408683ecabd
  - https://gist.github.com/Cristliu/298f51cbc72c45d91632cd0d65aa8161
  - https://github.com/langgenius/dify
  - https://github.com/langgenius/dify/releases/tag/1.0.1
  - http://dify.com