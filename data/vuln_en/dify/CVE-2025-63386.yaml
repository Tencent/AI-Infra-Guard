info:
  name: dify
  cve: CVE-2025-63386
  summary: Dify v1.9.1 has a CORS misconfiguration vulnerability in the /console/api/setup endpoint.
  details: |
    A Cross-Origin Resource Sharing (CORS) misconfiguration vulnerability exists in Dify v1.9.1 in the /console/api/setup endpoint.
    The endpoint implements an insecure CORS policy that reflects any Origin header and enables Access-Control-Allow-Credentials: true,
    permitting arbitrary external domains to make authenticated requests.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. Upgrade Dify to a version that addresses this CORS misconfiguration.
    2. Implement strict CORS policies on the `/console/api/setup` endpoint, ensuring only trusted origins are allowed.
    3. Avoid reflecting arbitrary `Origin` headers and disable `Access-Control-Allow-Credentials: true` for untrusted origins.
rule: version == "1.9.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-63386
  - https://gist.github.com/Cristliu/1610daac87c711ac3e0250c58f5cc4f9
  - https://gist.github.com/Cristliu/8ad993126be05c9210c71cc7d49fa112
  - https://github.com/langgenius/dify/discussions