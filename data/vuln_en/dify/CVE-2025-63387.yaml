info:
  name: dify
  cve: CVE-2025-63387
  summary: Dify v1.9.1 is vulnerable to Insecure Permissions, allowing unauthenticated access to sensitive system configuration data.
  details: |
    An unauthenticated attacker can directly send HTTP GET requests to the `/console/api/system-features` endpoint without any authentication credentials or session tokens. The endpoint fails to implement proper authorization checks, allowing anonymous access to sensitive system configuration data.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Implement proper authentication and authorization checks for the `/console/api/system-features` endpoint.
    2. Ensure that sensitive system configuration data is not accessible to unauthenticated users.
    3. Review and update access control policies for all API endpoints.
rule: version == "1.9.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-63387
  - https://github.com/langgenius/dify/issues/31368#issuecomment-3783712203
  - https://github.com/langgenius/dify/pull/31392
  - https://github.com/langgenius/dify/pull/31417
  - https://gist.github.com/Cristliu/cddc0cbbf354de51106ab63a11be94af
  - https://gist.github.com/Cristliu/dfc5f3a31dc6d7fff2754867e5c649a5
  - https://github.com/langgenius/dify/discussions