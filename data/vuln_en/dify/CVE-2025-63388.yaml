info:
  name: dify
  cve: CVE-2025-63388
  summary: Dify v1.9.1 is vulnerable to a CORS misconfiguration allowing unauthorized cross-origin requests.
  details: |
    A Cross-Origin Resource Sharing (CORS) misconfiguration vulnerability exists in Dify v1.9.1 in the `/console/api/system-features` endpoint.
    The endpoint implements an overly permissive CORS policy that reflects arbitrary Origin headers and sets `Access-Control-Allow-Credentials: true`,
    allowing any external domain to make authenticated cross-origin requests.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
  severity: CRITICAL
  security_advise: |
    1. Upgrade Dify to a version that addresses this CORS misconfiguration.
    2. Implement strict CORS policies on the `/console/api/system-features` endpoint, allowing only trusted origins.
    3. Avoid reflecting arbitrary `Origin` headers and ensure `Access-Control-Allow-Credentials` is not set to `true` for untrusted origins.
rule: version == "1.9.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-63388
  - https://gist.github.com/Cristliu/5ded6d03e41d7d66ecb1b568bae3ff6c
  - https://gist.github.com/Cristliu/c2bc7d05abd89db8eb542a453a528d77
  - https://github.com/langgenius/dify/discussions