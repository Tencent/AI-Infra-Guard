info:
  name: langchain
  cve: CVE-2024-58340
  summary: LangChain suffers from a Regular Expression Denial-of-Service (ReDoS) vulnerability in the MRKLOutputParser.parse() method.
  details: |
    LangChain versions up to and including 0.3.1 contain a regular expression denial-of-service (ReDoS) vulnerability in the MRKLOutputParser.parse() method (libs/langchain/langchain/agents/mrkl/output_parser.py). The parser applies a backtracking-prone regular expression when extracting tool actions from model output. An attacker who can supply or influence the parsed text (for example via prompt injection in downstream applications that pass LLM output directly into MRKLOutputParser.parse()) can trigger excessive CPU consumption by providing a crafted payload, causing significant parsing delays and a denial-of-service condition.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade LangChain to a version greater than 0.3.1.
    2. Implement input validation and sanitization for data passed to `MRKLOutputParser.parse()` to prevent crafted payloads.
    3. Consider using alternative parsing mechanisms or libraries that are not susceptible to ReDoS vulnerabilities if upgrading is not immediately feasible.
rule: version <= "0.3.1"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-58340
  - https://github.com/langchain-ai/langchain
  - https://huntr.com/bounties/e7ece02c-d4bb-4166-8e08-6baf4f8845bb
  - https://www.langchain.com
  - https://www.vulncheck.com/advisories/langchain-mrkloutputparser-redos