info:
  name: langchain
  cve: CVE-2025-46059
  summary: Indirect prompt injection in GmailToolkit allows remote code execution
  details: |
    The langchain-ai library version 0.3.51 contains an indirect prompt injection vulnerability 
    in the GmailToolkit component. An attacker can craft a malicious email that, when processed 
    by the toolkit, leads to arbitrary code execution and full application compromise.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to langchain>=0.3.52 or apply vendor patch
    2. Avoid processing untrusted emails with GmailToolkit
    3. Implement input sanitization for external data sources
    4. Review and restrict permissions of agents using toolkits
rule: version >= "0.0.0" && version < "0.3.52"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-46059
  - https://github.com/langchain-ai/langchain-community/issues/217#issuecomment-3144824471
  - https://github.com/langchain-ai/langchain/issues/30833
  - https://github.com/Jr61-star/CVEs/blob/main/CVE-2025-46059.md
  - https://python.langchain.com/docs/security