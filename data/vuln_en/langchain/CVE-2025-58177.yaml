info:
  name: langchain
  cve: CVE-2025-58177
  summary: Stored XSS in n8n LangChain Chat Trigger Node via initialMessages parameter
  details: |
    A stored Cross-Site Scripting (XSS) vulnerability was found in the `@n8n/n8n-nodes-langchain.chatTrigger` node. 
    If an attacker configures the node with malicious JavaScript in the `initialMessages` field and enables public access, 
    the script executes in the browser of anyone visiting the public chat URL. This can lead to session hijacking, 
    sensitive data theft, or phishing attacks.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade n8n to version >=1.107.0
    2. Disable the `n8n-nodes-langchain.chatTrigger` node if not required ([docs](https://docs.n8n.io/hosting/securing/blocking-nodes/))
    3. Sanitize all user-provided inputs, especially those used in UI-rendered fields like `initialMessages`
rule: version >= "1.24.0" && version < "1.107.0"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-mvh4-2cm2-6hpg
  - https://nvd.nist.gov/vuln/detail/CVE-2025-58177
  - https://github.com/n8n-io/n8n/pull/18148
  - https://github.com/n8n-io/n8n/commit/d4ef191be0b39b65efa68559a3b8d5dad2e102b2
  - https://docs.n8n.io/hosting/securing/blocking-nodes