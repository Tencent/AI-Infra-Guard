info:
  name: langchain
  cve: CVE-2025-68665
  summary: LangChain serialization injection vulnerability enables secret extraction.
  details: |
    A serialization injection vulnerability exists in LangChain JS's `toJSON()` method due to improper escaping of user-controlled data containing `'lc'` keys. This allows attackers to inject malicious LangChain object structures, potentially leading to secret extraction (e.g., environment variables) or arbitrary class instantiation with attacker-controlled parameters.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade `@langchain/core` to version `1.1.8` or higher.
    2. Upgrade `langchain` to version `1.2.3` or higher.
    3. If you need to load secrets, provide them explicitly using `secretsMap` instead of relying on `secretsFromEnv: true`.
    4. Only enable `secretsFromEnv: true` if you explicitly trust the serialized data.
    5. For deeply nested structures, adjust the `maxDepth` parameter in `load()` if necessary.
    6. When using custom import maps, ensure they only contain trusted modules and never populate them from user input.
rule: (version > "0" && version < "0.3.80") || (version > "1.0.0" && version < "1.1.8") || (version > "0" && version < "0.3.37") || (version > "1.0.0" && version < "1.2.3")
references:
  - https://github.com/langchain-ai/langchainjs/security/advisories/GHSA-r399-636x-v7f6
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68665
  - https://github.com/langchain-ai/langchainjs/commit/e5063f9c6e9989ea067dfdff39262b9e7b6aba62
  - https://github.com/langchain-ai/langchainjs
  - https://github.com/langchain-ai/langchainjs/releases/tag/%40langchain%2Fcore%401.1.8
  - https://github.com/langchain-ai/langchainjs/releases/tag/langchain%401.2.3