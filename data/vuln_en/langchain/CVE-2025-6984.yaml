info:
  name: langchain
  cve: CVE-2025-6984
  summary: Langchain Community vulnerable to XML External Entity (XXE) attacks
  details: |
    The `EverNoteLoader` component in the `langchain-community` package is susceptible to XML External Entity (XXE) attacks due to insecure usage of `etree.iterparse()` without disabling external entity references. This can allow attackers to disclose sensitive local files by submitting malicious XML payloads. The vulnerability has been addressed in version 0.3.27.
  cvss: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade `langchain-community` to version >= 0.3.27
    2. Review and sanitize XML input processing logic if custom parsing is implemented
    3. Apply principle of least privilege to file access in document loaders
rule: version >= "0" && version < "0.3.27"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-6984
  - https://github.com/langchain-ai/langchain-community/commit/e842452108089524e22c3a2ced851c021884556f
  - https://github.com/langchain-ai/langchain-community
  - https://github.com/langchain-ai/langchain/blob/d79b5813a0b3b243c612b77013768995e46c4337/libs/langchain/langchain/document_loaders/evernote.py#L1-L23
  - https://huntr.com/bounties/a6b521cf-258c-41c0-9edb-d8ef976abb2a