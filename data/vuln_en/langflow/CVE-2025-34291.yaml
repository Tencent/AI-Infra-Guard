info:
  name: langflow
  cve: CVE-2025-34291
  summary: Langflow CORS misconfiguration enables Account Takeover and RCE.
  details: |
    Langflow versions up to and including 1.6.9 contain a chained vulnerability that enables account takeover and remote code execution.
    An overly permissive CORS configuration (allow_origins='*' with allow_credentials=True) combined with a refresh token cookie configured as SameSite=None allows a malicious webpage to perform cross-origin requests that include credentials and successfully call the refresh endpoint.
    An attacker-controlled origin can therefore obtain fresh access_token / refresh_token pairs for a victim session.
    Obtained tokens permit access to authenticated endpoints — including built-in code-execution functionality — allowing the attacker to execute arbitrary code and achieve full system compromise.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade Langflow to a version greater than 1.6.9.
    2. Review and restrict CORS configurations to only trusted origins.
    3. Ensure refresh token cookies are configured with appropriate SameSite policies (e.g., `SameSite=Lax` or `SameSite=Strict`) to prevent cross-site credential leakage.
rule: version > "0" && version <= "1.6.9"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-34291
  - https://github.com/langflow-ai/langflow/pull/10139
  - https://github.com/langflow-ai/langflow/pull/10696
  - https://github.com/langflow-ai/langflow/pull/9240
  - https://github.com/langflow-ai/langflow/pull/9441
  - https://github.com/langflow-ai/langflow
  - https://www.obsidiansecurity.com/blog/cve-2025-34291-critical-account-takeover-and-rce-vulnerability-in-the-langflow-ai-agent-workflow-platform
  - https://www.vulncheck.com/advisories/langflow-cors-misconfiguration-to-token-hijack-and-rce