info:
  name: langflow
  cve: CVE-2025-57760
  summary: Privilege escalation via CLI superuser creation in Langflow
  details: |
    A privilege escalation vulnerability exists in Langflow containers where an authenticated user with remote code execution (RCE) access can invoke the internal CLI command `langflow superuser` to create a new administrative user. This bypasses frontend and backend role checks, granting full superuser access.
    The vulnerability arises because the `/app/.venv/bin/langflow` binary exposes sensitive CLI commands that are not restricted based on user roles. An attacker who gains RCE (e.g., through the `/api/v1/validate/code` endpoint) can execute:
    ```
    /app/.venv/bin/langflow superuser
    ```
    This creates a new admin user, allowing full control over the Langflow instance, including access to all user data, flows, credentials, and environment variables.
    ### Impact:
    
    - Full compromise of the Langflow application
    - Unauthorized access to stored credentials and API keys
    - Ability to manage or delete other users
    - Potential for resource exhaustion by spawning additional instances
    
    ### Proof of Concept (PoC):
    
    1. Start container with `LANGFLOW_ENABLE_AUTH=true`.
    2. Register as a normal user via the UI.
    3. Use RCE to spawn a reverse shell.
    4. Execute the `langflow superuser` command inside the container.
    5. Log in as the newly created superuser.
cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
severity: HIGH
security_advise: |
  1. Upgrade to Langflow version >= 1.5.1 (when available) to apply proper privilege restrictions.
  2. Restrict access to the `/api/v1/validate/code` endpoint to trusted sources only.
  3. Disable or remove unnecessary CLI binaries within production containers.
  4. Audit running containers for unexpected superusers and reset all admin credentials.
  5. Implement runtime security monitoring to detect abnormal CLI usage.
rule: version >= "0" && version < "1.5.1"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-4gv9-mp8m-592r
  - https://github.com/langflow-ai/langflow