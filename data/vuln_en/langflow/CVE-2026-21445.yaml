info:
  name: langflow
  cve: CVE-2026-21445
  summary: Multiple critical API endpoints in Langflow are missing authentication controls, allowing any unauthenticated user to access sensitive user conversation data, transaction histories, and perform destructive operations.
  details: |
    The vulnerability exists in three API endpoints within `src/backend/base/langflow/api/v1/monitor.py` that are missing the required authentication dependency `dependencies=[Depends(get_current_active_user)]`.
    
    **Affected Endpoints:**
    1. **GET `/api/v1/monitor/messages`**: Allows access to all user conversations without authentication.
    2. **GET `/api/v1/monitor/transactions`**: Allows access to transaction history without authentication.
    3. **DELETE `/api/v1/monitor/messages/session/{session_id}`**: Allows deletion of user messages by session without authentication.
    
    This inconsistency is evident as other endpoints in the same file properly implement authentication. Attackers can exploit this to access sensitive data, violate privacy, and perform data destruction.
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:N/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. Upgrade `langflow-base` to version `0.7.1` or later.
    2. Upgrade `langflow` to version `1.7.1` or later.
    3. Ensure that the following API endpoints have the `dependencies=[Depends(get_current_active_user)]` authentication dependency applied:
        - `@router.get("/messages")`
        - `@router.get("/transactions")`
        - `@router.delete("/messages/session/{session_id}")`
rule: version < "0.7.1"
references:
  - https://github.com/langflow-ai/langflow/security/advisories/GHSA-c5cp-vx83-jhqx
  - https://nvd.nist.gov/vuln/detail/CVE-2026-21445
  - https://github.com/langflow-ai/langflow/commit/3fed9fe1b5658f2c8656dbd73508e113a96e486a
  - https://github.com/langflow-ai/langflow
  - https://github.com/langflow-ai/langflow/releases/tag/1.7.1