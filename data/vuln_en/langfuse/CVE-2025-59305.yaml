info:
  name: langfuse
  cve: CVE-2025-59305
  summary: Improper authorization in background migration endpoints allows authenticated users to invoke migration control functions.
  details: |
    In Langfuse versions prior to 3.1 (commit d67b317), improper authorization controls on background migration endpoints expose TRPC functions such as `backgroundMigrations.all`, `backgroundMigrations.status`, and `backgroundMigrations.retry` to any authenticated user. This can result in data corruption or denial of service through unauthorized access.
    The issue stems from insufficient permission checks, allowing low-privileged attackers with valid credentials to interfere with critical backend processes.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L
  severity: HIGH
  security_advise: |
    1. Upgrade to Langfuse version 3.1 or later (commit d67b317+).
    2. Review and restrict access to TRPC background migration endpoints.
    3. Implement proper role-based access control (RBAC) for administrative functions.
rule: version >= "3.0.0" && version < "3.1.0"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-59305
  - https://github.com/langfuse/langfuse/pull/9028
  - https://depthfirst.webflow.io/post/how-an-authorization-flaw-reveals-a-common-security-blind-spot-cve-2025-59305-case-study