info:
  name: mlflow
  cve: CVE-2026-22607
  summary: Fickling versions up to and including 0.1.6 do not treat Python's `cProfile` module as unsafe, leading to a blocklist bypass and potential arbitrary code execution.
  details: |
    The vulnerability in Fickling (versions <= 0.1.6) arises because the `cProfile` module, specifically `cProfile.run()` and `cProfile.runctx()`, is not included in its blocklist of unsafe imports. This omission allows a malicious pickle file utilizing `cProfile.run()` to be classified as "SUSPICIOUS" instead of "OVERTLY_MALICIOUS" by Fickling. Consequently, users relying on Fickling's output for pickle safety might inadvertently deserialize attacker-controlled code, leading to arbitrary code execution. This is similar to previous bypasses involving `pty` and `marshal/types`.
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. Upgrade Fickling to version 0.1.7 or later.
    2. Ensure that `cProfile`, `cProfile.run`, `cProfile.runctx`, and `_lsprof` are included in any custom blocklists for unsafe imports if not using the latest Fickling version.
    3. Exercise extreme caution when deserializing pickle files from untrusted sources, even if they are flagged as "SUSPICIOUS" by security tools.
rule: version > "0" && version < "0.1.7"
references:
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-565g-hwwr-4pp3
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-p523-jq9w-64x9
  - https://github.com/trailofbits/fickling/security/advisories/GHSA-r7v6-mfhq-g3m2
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22607
  - https://github.com/trailofbits/fickling/pull/108
  - https://github.com/trailofbits/fickling/pull/187
  - https://github.com/trailofbits/fickling/pull/195
  - https://github.com/trailofbits/fickling/commit/dc8ae12966edee27a78fe05c5745171a2b138d43
  - https://github.com/trailofbits/fickling
  - https://github.com/trailofbits/fickling/blob/977b0769c13537cd96549c12bb537f05464cf09c/test/test_bypasses.py#L116
  - https://github.com/trailofbits/fickling/releases/tag/v0.1.7