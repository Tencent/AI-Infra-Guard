info:
  name: n8n
  cve: CVE-2025-52478
  summary: Stored XSS in n8n Form Trigger allows Account Takeover via injected iframe and video/source.
  details: |
    A stored Cross-Site Scripting (XSS) vulnerability exists in the n8n Form Trigger node's HTML form element.
    An authenticated attacker can inject malicious HTML via an `<iframe>` with a `srcdoc` payload or
    a `<video>` tag coupled with a `<source>` tag using an `onerror` event. This allows for Account Takeover (ATO)
    by exfiltrating `n8n-browserId` and session cookies from authenticated users, enabling impersonation and
    account detail modification.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to n8n version >=1.98.2.
    2. Configure a reverse proxy to serve webhook requests from a different domain.
    3. Disable or restrict the use of the Form Trigger node, particularly the HTML element type.
    4. Implement a Content Security Policy (CSP) to block inline scripts and disallow `srcdoc`.
rule: version >= "1.77.0" && version < "1.98.2"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-hfmv-hhh3-43f2
  - https://nvd.nist.gov/vuln/detail/CVE-2025-52478
  - https://github.com/n8n-io/n8n/pull/16329
  - https://github.com/n8n-io/n8n/commit/7940384a85041a1890b1203d69c092c887312500
  - https://github.com/n8n-io/n8n
  - https://cheatsheetseries.owasp.org/cheatsheets/XSS_Prevention_Cheat_Sheet.html
  - https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-srcdoc
  - https://html.spec.whatwg.org/multipage/webappapis.html#handler-onerror