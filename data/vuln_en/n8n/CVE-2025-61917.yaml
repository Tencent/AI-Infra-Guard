info:
  name: n8n
  cve: CVE-2025-61917
  summary: n8n's Unsafe Buffer Allocation Allows In-Process Memory Disclosure in Task Runner.
  details: |
    The vulnerability in n8n stems from the use of `Buffer.allocUnsafe()` and `Buffer.allocUnsafeSlow()` in the task runner, allowing untrusted code to allocate uninitialized memory. This could lead to information disclosure by exposing residual data from within the same Node.js process, such as data from prior requests, tasks, secrets, or tokens. This issue affects deployments where Task Runners are enabled (`N8N_RUNNERS_ENABLED=true`) and the Code Node is enabled.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to n8n version >= 1.114.3 or 1.115.0 as soon as possible.
    2. If an immediate upgrade is not possible, disable the Code Node by adding `n8n-nodes-base.code` to the `NODES_EXCLUDE` environment variable.
    3. Prefer external mode for isolation by running Task Runners in external mode, which executes untrusted task code in a separate sidecar container, reducing the risk of in-process memory disclosure.
rule: version > "1.65.0" && version < "1.114.3"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-49mx-fj45-q3p6
  - https://nvd.nist.gov/vuln/detail/CVE-2025-61917
  - https://github.com/n8n-io/n8n/commit/2c4c2953199733c791f739a40879ae31ca129aba
  - https://github.com/n8n-io/n8n
  - https://nodejs.org/docs/latest-v22.x/api/buffer.html#static-method-bufferallocsize-fill-encoding
  - https://nodejs.org/docs/latest-v22.x/api/buffer.html#static-method-bufferallocunsafesize
  - https://docs.n8n.io/hosting/configuration/task-runners/
  - https://docs.n8n.io/hosting/securing/blocking-nodes/