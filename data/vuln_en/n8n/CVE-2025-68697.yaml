info:
  name: n8n
  cve: CVE-2025-68697
  summary: Self-hosted n8n instances with legacy Code node execution are vulnerable to arbitrary file read/write.
  details: |
    In self-hosted n8n instances, when the Code node operates in legacy (non-task-runner) JavaScript execution mode,
    authenticated users with workflow editing access can invoke internal helper functions. This allows them to perform
    arbitrary file read and write operations on the n8n host with the same privileges as the n8n process,
    potentially leading to data exfiltration or system compromise.
  cvss: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to n8n version 2.0.0 or later, which enables task runners by default for Code node execution.
    2. For n8n version 1.71.0 and above, enable task runners by setting `N8N_RUNNERS_ENABLED=true`.
    3. If immediate migration to task runners is not possible, limit file operations by setting `N8N_RESTRICT_FILE_ACCESS_TO` to a dedicated, non-sensitive directory.
    4. Ensure `N8N_BLOCK_FILE_ACCESS_TO_N8N_FILES=true` (default) to block access to `.n8n` and user-defined config files.
    5. If workflow editors are not fully trusted, consider disabling high-risk nodes (including the Code node) using `NODES_EXCLUDE`.
rule: version > "1.2.1" && version < "2.0.0"
references:
  - https://github.com/n8n-io/n8n/security/advisories/GHSA-j4p8-h8mh-rh8q
  - https://nvd.nist.gov/vuln/detail/CVE-2025-68697
  - https://github.com/n8n-io/n8n
  - https://docs.n8n.io/hosting/configuration/task-runners/
  - https://docs.n8n.io/hosting/configuration/environment-variables/task-runners/
  - https://docs.n8n.io/hosting/configuration/environment-variables/security/#security-environment-variables
  - https://docs.n8n.io/2-0-breaking-changes/#enable-task-runners-by-default