info:
  name: ollama
  cve: CVE-2025-15514
  summary: Ollama suffers from a null pointer dereference vulnerability in multi-modal image processing, leading to denial of service.
  details: |
    Ollama versions 0.11.5-rc0 through 0.13.5 contain a null pointer dereference vulnerability within the multi-modal model image processing functionality. When processing base64-encoded image data via the `/api/chat` endpoint, the application fails to validate that the decoded data represents valid media before passing it to the `mtmd_helper_bitmap_init_from_buf` function. This function can return NULL for malformed input, but the code does not check this return value before dereferencing the pointer in subsequent operations. A remote attacker can exploit this by sending specially crafted base64 image data that decodes to invalid media, causing a segmentation fault and crashing the runner process. This results in a denial of service condition where the model becomes unavailable to all users until the service is restarted.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
  severity: HIGH
  security_advise: |
    1. Upgrade Ollama to a version that addresses this vulnerability.
    2. Implement robust input validation for base64-encoded image data to ensure it represents valid media before processing.
    3. Ensure proper null pointer checks are in place for return values from functions like `mtmd_helper_bitmap_init_from_buf`.
rule: version >= "0.11.5-rc0" && version <= "0.13.5"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-15514
  - https://https://github.com/ollama/ollama
  - https://huntr.com/bounties/172df98b-07cd-41ea-a628-366f8cd525c0
  - https://ollama.com
  - https://www.vulncheck.com/advisories/ollama-multi-modal-image-processing-null-pointer-dereference