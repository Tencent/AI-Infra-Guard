info:
  name: ollama
  cve: CVE-2025-51471
  summary: Cross-Domain Token Exposure in Ollama
  details: |
    A vulnerability in `server.auth.getAuthorizationToken` of Ollama 0.6.7 allows remote attackers 
    to steal authentication tokens and bypass access controls. This occurs when a malicious 
    `WWW-Authenticate` header with a crafted realm value is returned by the `/api/pull` endpoint.
  cvss: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:L/A:N
  severity: MEDIUM
  security_advise: |
    1. Upgrade to ollama version >= 0.9.7 to mitigate the vulnerability.
    2. Implement strict validation for WWW-Authenticate headers.
    3. Review and restrict CORS policies to prevent cross-domain token leakage.
rule: version >= "0.6.7" && version < "0.9.7"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51471
  - https://github.com/ollama/ollama/pull/10750
  - https://github.com/ollama/ollama
  - https://www.gecko.security/blog/cve-2025-51471