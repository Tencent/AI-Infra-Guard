info:
  name: pyload-ng
  cve: CVE-2025-54140
  summary: Authenticated path traversal in pyLoad NG allows arbitrary file write
  details: |
    An authenticated path traversal vulnerability exists in the `/json/upload` endpoint of pyLoad NG. By manipulating the filename of an uploaded file (e.g., using `../../../../etc/passwd`), an attacker can write files to arbitrary locations on the system with the privileges of the pyLoad process.
    The vulnerable code does not sanitize the `filename` parameter:
    ```python
    @json_blueprint.route("/upload", methods=["POST"])
    def upload():
        dir_path = api.get_config_value("general", "storage_folder")
        for file in request.files.getlist("file"):
            file_path = os.path.join(dir_path, "tmp_" + file.filename)  
            file.save(file_path) 
    ```
    This can lead to Remote Code Execution (RCE), privilege escalation, persistence mechanisms, and full system compromise depending on where the file is written and how it's processed.
    Proof of concept:
    
    1. Authenticate and obtain session cookie
    2. Upload a file with a maliciously crafted filename that includes directory traversal sequences
    3. The server writes the file outside the intended directory, potentially achieving remote code execution through scheduled tasks or web-accessible paths.
cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
severity: HIGH
security_advise: |
  1. Upgrade to version `pyload-ng>=0.5.0b3.dev90` which contains the fix.
  2. Apply input validation and sanitization to all user-supplied filenames before saving files.
  3. Restrict file upload directories and ensure they are non-executable.
  4. Audit existing installations for unexpected files in system paths such as `/etc/cron.d/`.
rule: version >= "0.5.0b3.dev89" && version < "0.5.0b3.dev90"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-xqpg-92fq-grfg
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54140
  - https://github.com/pyload/pyload/commit/fc4b136e9c4e7dcbb8e467ae802cb2c3f70a71b0
  - https://github.com/pyload/pyload
  - https://github.com/pyload/pyload/blob/df094db67ec6e25294a9ac0ddb4375fd7fb9ba00/src/pyload/webui/app/blueprints/json_blueprint.py#L109