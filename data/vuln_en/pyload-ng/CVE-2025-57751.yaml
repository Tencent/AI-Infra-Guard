info:
  name: pyload-ng
  cve: CVE-2025-57751
  summary: Denial-of-Service vulnerability in pyLoad CNL Blueprint via dukpy.evaljs
  details: |
    The vulnerability exists in the `flash/addcrypted2` endpoint of the pyLoad CNL Blueprint where the `jk` parameter is used directly in a call to `dukpy.evaljs()` without proper sanitization or validation. This allows an attacker to submit arbitrary JavaScript code that consumes excessive CPU resources, leading to a denial-of-service condition.
    Affected code snippet:
    ```python
    @bp.route("/flash/addcrypted2", methods=["POST"], endpoint="addcrypted2")
    @local_check
    def addcrypted2():
        ...
        jk = flask.request.form["jk"]
        ...
        jk = eval_js(f"{jk} f()")
    ```
    When combined with `dukpy.evaljs`, this leads to full CPU exhaustion as demonstrated by the provided PoC.
  cvss: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/E:P
  severity: HIGH
  security_advise: |
    1. Upgrade to version >=0.5.0b3.dev92 of `pyload-ng`.
    2. Avoid passing unsanitized user input into JavaScript evaluation functions such as `dukpy.evaljs`.
    3. Implement strict input validation and sanitization on all parameters received from untrusted sources.
rule: version >= "0" && version < "0.5.0b3.dev92"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-9gjj-6gj7-c4wj
  - https://nvd.nist.gov/vuln/detail/CVE-2025-57751
  - https://github.com/pyload/pyload