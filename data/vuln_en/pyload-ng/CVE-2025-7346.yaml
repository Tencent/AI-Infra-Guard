info:
  name: pyload-ng
  cve: CVE-2025-7346
  summary: Unauthenticated attackers can bypass localhost restrictions to create arbitrary packages in pyLoad
  details: |
    The vulnerability allows any unauthenticated attacker to bypass localhost restrictions by setting the `Host` header to `127.0.0.1:9666`. This enables unauthorized access to protected endpoints such as `/flash/add`, which should only be accessible locally or by authenticated users.
    The root cause lies in the `local_check` middleware that improperly validates the source of incoming requests based on the `HTTP_HOST` environment variable. An example of this flawed logic exists in the CNL blueprint where route protection is circumvented through header manipulation.
    Proof-of-concept demonstrates successful injection of a package via the bypassed endpoint, confirming the risk of unauthorized actions being performed remotely without authentication.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to a patched version of pyload-ng after commit f4e2d12416ba2dfac7b036d5c8d6dab5461b9840
    2. Implement stricter input validation for HTTP headers used in access control decisions
    3. Restrict network exposure of the web UI to trusted sources using firewall rules or reverse proxy configurations
rule: version <= "0.5.0b3.dev88"
references:
  - https://github.com/pyload/pyload/security/advisories/GHSA-x698-5hjm-w2m5
  - https://github.com/pyload/pyload/commit/f4e2d12416ba2dfac7b036d5c8d6dab5461b9840
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L21-L36
  - https://github.com/pyload/pyload/blob/4159a1191ec4fe6d927e57a9c4bb8f54e16c381d/src/pyload/webui/app/blueprints/cnl_blueprint.py#L56-L58C11