info:
  name: ragflow
  cve: CVE-2025-51462
  summary: Stored XSS vulnerability in RAGFlow allows remote code execution via unsanitized input
  details: |
    A Stored Cross-site Scripting (XSS) vulnerability exists in the `api.apps.dialog_app.set_dialog` function of RAGFlow 0.17.2.
    Remote attackers can inject arbitrary JavaScript by submitting crafted input to the assistant greeting field.
    This input is stored without sanitization and later rendered using a markdown component with `rehype-raw`,
    enabling client-side script execution when the content is displayed.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
  severity: HIGH
  security_advise: |
    1. Upgrade to a patched version of RAGFlow where input sanitization is enforced
    2. Implement strict output encoding for all user-supplied data before rendering
    3. Avoid using raw HTML rendering libraries such as `rehype-raw` on untrusted input
rule: version == "0.17.2"
references:
  - https://nvd.nist.gov/vuln/detail/CVE-2025-51462
  - https://github.com/infiniflow/ragflow/pull/7250
  - https://github.com/infiniflow/ragflow
  - https://www.gecko.security/blog/cve-2025-51462