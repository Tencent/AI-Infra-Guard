info:
  name: vllm
  cve: CVE-2026-22778
  summary: A chain of vulnerabilities in vLLM, including an information leak and a heap overflow, allows for Remote Code Execution (RCE) when processing malicious video URLs.
  details: |
    The vulnerability chain in vLLM enables Remote Code Execution (RCE) through two primary flaws:
    1. **Information Leak (ASLR Bypass):** Sending an invalid image to vLLM's multimodal endpoint causes PIL to throw an error, which is returned to the client and leaks a heap address. This significantly reduces the effectiveness of ASLR.
    2. **Heap Overflow:** vLLM uses OpenCV (cv2) to decode videos, which bundles FFmpeg 5.1.x. The JPEG2000 decoder within FFmpeg contains a heap overflow vulnerability. A malicious `cdef` box in a JPEG2000 frame can remap the Y (luma) channel into the smaller U (chroma) buffer, leading to a heap overflow. This overflow can be exploited to overwrite an `AVBuffer` structure's `free()` function pointer with `system()`, allowing arbitrary command execution when the buffer is freed.
    This exploit is feasible through the `/v1/chat/completions` and `/v1/invocations` endpoints when a `video_url` is provided. Deployments not serving a video model are not affected.
  cvss: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  severity: CRITICAL
  security_advise: |
    1. Upgrade vLLM to version `0.14.1` or later.
    2. Ensure that only trusted video sources are processed if upgrading is not immediately possible.
    3. Review and implement authentication mechanisms for vLLM instances, although this exploit can bypass pre-auth in some configurations.
rule: version >= "0.8.3" && version < "0.14.1"
references:
  - https://github.com/vllm-project/vllm/security/advisories/GHSA-4r2x-xpjr-7cvv
  - https://nvd.nist.gov/vuln/detail/CVE-2026-22778
  - https://github.com/vllm-project/vllm/pull/31987
  - https://github.com/vllm-project/vllm/pull/32319
  - https://github.com/vllm-project/vllm/pull/32668
  - https://github.com/vllm-project/vllm
  - https://github.com/vllm-project/vllm/releases/tag/v0.14.1