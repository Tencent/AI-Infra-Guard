# AI-Infra-Guard 系统架构演进（v0.1 / v2.6 / v3.6.0）

> 说明：以下架构描述基于版本定位与能力演进整理，强调系统职责划分、关键能力与运行流。

## v0.1 架构概览

**定位**：单体化 AI 基础设施漏洞扫描工具，强调轻量与快速落地。

**版本变更要点**

- 初版能力集中在基础设施漏洞扫描
- CLI 为主的扫描调度流程，WebUI 作为结果展示入口

**技术栈与交付**

- Go 单体实现，编译为单一二进制
- 以命令行触发任务，输出结构化扫描结果

**系统分层（职责视角）**

1. **入口与交互层**：CLI 触发扫描，WebUI 展示结果
2. **任务调度层**：目标拆分、并发控制、任务回收
3. **规则引擎层**：指纹识别、漏洞匹配、规则计算
4. **探测执行层**：HTTP/服务探测与组件识别
5. **规则数据层**：指纹库与漏洞规则库

**运行流（文字示意）**

```
CLI/WebUI
  -> 调度层
     -> 规则引擎
        -> 结果输出
```

---

## v2.6 架构概览

**定位**：在 v0.1 之上增加 MCP Server 安全检测，形成“扫描 + MCP 代码分析 + WebUI”三大能力。

**版本变更要点**

- 新增 MCP Server 代码安全分析能力
- WebUI 与功能执行形成一体化部署形态

**技术栈与交付**

- Go 单体实现，编译为单一二进制
- 单进程覆盖扫描、MCP 分析与结果展示

**系统分层（职责视角）**

1. **入口与交互层**：CLI 子命令 + WebUI 统一入口
2. **安全检测层**
   - AI 基础设施扫描：规则驱动的识别与漏洞匹配
   - MCP 安全分析：Agent 驱动的代码安全检测
3. **任务与通用能力层**：任务编排、结果归集、通用工具能力
4. **规则与数据层**：指纹规则库、漏洞规则库

**运行流（文字示意）**

```
CLI
  -> scan: 规则引擎 -> 漏洞匹配
  -> mcp : Agent 分析 -> 风险报告
WebUI
  -> 统一入口 -> 结果展示
```

---

## v3.6.0 架构概览

**定位**：平台化 AI 红队系统，支持多模块协同与多场景部署（企业内网、SaaS、开源版）。

**版本变更要点**

- 平台化：从单体工具扩展为多模块协作系统
- 引入 Prompt 安全评测与多语言扫描能力

**技术栈与部署**

- Go + Python 混合架构（核心服务 + Agent/评测能力）
- Docker 适配全环境部署（镜像化 + Compose）

**架构分层解耦（业务视角）**

1. **适配层**
   - 内网适配：SSO 与企业内部依赖
   - SaaS：多用户隔离与租户管理
   - 开源版：去除内部依赖的通用部署
2. **业务逻辑层**
   - 任务调度、结果聚合、报告生成
   - 三大功能模块：AI 基础设施扫描、MCP 安全扫描、大模型体检
3. **扫描引擎层**
   - 统一扫描接口协议
   - 多语言扫描模块热插拔（Python / Go）

**能力编排（职责视角）**

1. **接入与编排**：CLI/WebUI/API 统一入口，Agent 运行时与任务编排
2. **安全能力体系**：AI 基础设施扫描、MCP 安全扫描、Prompt 安全评测
3. **任务与报告**：任务调度、结果聚合、报告生成
4. **规则与数据**：指纹/漏洞规则库、MCP 规则与测试样例、评测数据集

**运行流（文字示意）**

```
WebUI / CLI
  -> 调度层（Runner / Agent）
     -> 基础设施扫描（指纹 + 漏洞规则）
     -> MCP 安全分析（Agent 驱动）
     -> Prompt 安全评测（评测能力）
  -> 报告输出（API / Web 展示）
```

---

## 版本对比要点（简表）

| 版本 | 主要能力 | 技术栈/交付 | 架构特征 |
| --- | --- | --- | --- |
| v0.1 | 基础设施漏洞扫描 + WebUI | Go 单体二进制 | 单体扫描工具，规则驱动 |
| v2.6 | 扫描 + MCP 代码检测 | Go 单体二进制 | 双引擎能力，WebUI 一体化 |
| v3.6.0 | 扫描 + MCP + Prompt 安全评测 | Go + Python，Docker 全环境 | 平台化、多场景适配、引擎可插拔 |
