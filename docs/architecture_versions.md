# AI-Infra-Guard 系统架构演进（v0.1 / v2.6 / v3.6.0）

> 说明：以下架构描述基于对应版本的发布记录与能力演进梳理，聚焦功能与系统边界。

## v0.1 架构概览

**定位**：轻量化 AI 基础设施漏洞扫描工具，提供 CLI 与 WebUI 入口。

**版本变更要点**

- 初版能力聚焦 AI 基础设施漏洞扫描
- CLI 为主的扫描调度流程，WebUI 作为补充入口

**技术栈与交付**

- Go 单体实现，编译为单一二进制
- 命令行入口为主，负责扫描调度与执行

**核心架构分层**

1. **交互层**
   - CLI 入口（本地扫描与配置）
   - WebUI（结果查看与交互展示）
 2. **扫描调度层**
   - 任务分发、并发控制、结果回收
 3. **规则引擎层**
   - 指纹识别与漏洞匹配
 4. **基础探测层**
   - HTTP/服务探测、组件识别
 5. **规则与数据层**
   - 组件指纹库与漏洞规则库

**简化调用链（文字示意）**

```
CLI/WebUI
  -> 调度层
     -> 规则引擎
        -> 结果输出
```

---

## v2.6 架构概览

**定位**：在 v0.1 的基础上新增 MCP Server 安全检测能力，形成“扫描 + MCP 代码分析 + WebUI”三大模块。

**版本变更要点**

- 引入 MCP Server 代码安全分析能力
- WebUI 与功能执行形成一体化部署形态

**技术栈与交付**

- Go 单体实现，编译为单一二进制
- WebUI 与功能执行合并部署（扫描 + MCP 代码分析）

**核心架构分层**

1. **交互层**
   - CLI 子命令体系（`scan` / `mcp` / `webserver`）
   - WebUI：统一入口与结果展示
2. **安全检测层**
   - **AI 组件漏洞扫描**：规则驱动的指纹识别与漏洞匹配
   - **MCP Server 代码检测**：基于 Agent 的安全分析
 3. **任务与基础能力层**
   - 通用任务执行与结果汇总
 4. **规则与数据层**
   - 指纹规则与漏洞库

**简化调用链（文字示意）**

```
CLI
  -> scan: 规则引擎 -> 漏洞匹配
  -> mcp : Agent 分析 -> 风险报告
WebUI
  -> WebSocket API -> 调用 scan/mcp
```

---

## v3.6.0 架构概览

**定位**：完整 AI 红队平台化版本，形成“基础设施扫描 + MCP 生态安全 + Prompt 安全评测 + Web 平台”的多模块体系。

**版本变更要点**

- 平台化：从单体工具扩展为多模块协作系统
- 引入 Prompt 安全评测与多语言扫描能力

**技术栈与部署**

- Go + Python 混合架构（核心服务 + Agent/评测能力）
- Docker 适配全环境部署（镜像化 + Compose）

**架构分层解耦（面向多场景适配）**

1. **适配层**
   - 内网适配：SSO 与企业内部依赖
   - SaaS：多用户隔离与租户管理
   - 开源版：去除内部依赖的通用部署
2. **业务逻辑层**
   - 任务调度、结果聚合、报告生成
   - 三大功能模块：AI 基础设施扫描、MCP 安全扫描、大模型体检
3. **扫描引擎层**
   - 统一扫描接口协议
   - 多语言扫描模块热插拔（Python / Go）

**核心模块映射**

1. **接入与编排**
   - CLI/WebUI/API 统一入口
   - Agent 运行时与任务编排
2. **安全能力体系**
   - AI 基础设施扫描
   - MCP 安全扫描
   - Prompt 安全评测
3. **任务与报告**
   - 任务调度、结果聚合、报告生成
4. **规则与数据**
   - 指纹与漏洞规则库
   - MCP 规则与测试样例
   - Prompt 评测数据集

**简化调用链（文字示意）**

```
WebUI / CLI
  -> 调度层（Runner / Agent）
     -> 基础设施扫描（指纹 + 漏洞规则）
     -> MCP 安全分析（Agent 驱动）
     -> Prompt 安全评测（评测能力）
  -> 报告输出（API / Web 展示）
```

---

## 版本对比要点（简表）

| 版本 | 主要能力 | 技术栈/交付 | 架构特征 |
| --- | --- | --- | --- |
| v0.1 | 基础设施漏洞扫描 + WebUI | Go 单体二进制 | 命令行入口 + 扫描调度 |
| v2.6 | 扫描 + MCP 代码检测 | Go 单体二进制 | WebUI + 功能执行一体 |
| v3.6.0 | 扫描 + MCP + Prompt 安全评测 | Go + Python，Docker 全环境 | 适配/业务/扫描引擎分层解耦 |
